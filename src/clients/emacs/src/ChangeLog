Fri Oct 30 18:10:34 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* Version 18.59 released.

Thu Oct 29 04:35:15 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* s-sco3-2-1.h, s-sco3-2-2.h: New files.

	* s-sco.h [HAVE_X11] (BSTRING, HAVE_RANDOM, LIB_STANDARD): Defined.
	[HAVE_X11] (LIBS_SYSTEM): #undef if defined above.
	[SCO_SOCKETS] (HAVE_TIMEVAL, USE_UTIME): Defined.

Tue Oct 27 14:33:37 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* m-next.h (ORDINARY_LINK): Defined.
	(LIB_STANDARD, NO_REMAP): #if 0'd.
	(KERNEL_FILE): Defined.

	* unexmips.c: Clear text_section->s_scnptr.

Sun Oct 25 00:44:32 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* process.c (wait_reading_process_input) [sun || apollo]:
	Don't try to deliver SIGIO if SIGIO is not defined.

Sat Oct 24 00:32:07 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* x11term.c (internal_socket_read): Process Mod1Mask for multichar
	keys as well as one-char keys.

Fri Oct 23 20:52:19 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* s-aix3-2.h (index, rindex): #undef them.

	* hftctl.c (hft_alrm, GT_ACK): Cast arg of `signal'.

	* x11term.c (XInitWindow): If can't find font, try font `fixed'.

	* m-ibmrs6000.h (BIG_ENDIAN): Define as 4321.

Wed Oct 21 18:24:12 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* m-sparc.h: Change the HAVE_SUN_WINDOWS conditional.

	* sunfns.c: New version from Peck.

Sun Oct 18 04:07:15 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* x11term.c (XInitWindow): Fix typo in NO_X_DESTROY_DATABASE test.

	* s-esix5r4.h (BROKEN_FIONREAD): Defined.

Fri Oct 16 04:27:07 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* fns.c (Fload_average): Handle NeXT like convex.

	* unexnext.c: New version from Lennart_Lovstrand@NeXT.COM.

	* emacs.c (main) [NeXT]: Make malloc_cookie external.

	* s-vms5-5.h: New file.

Sat Oct 10 07:41:06 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* m-ibmps2-aix.h [__GNUC__ >= 2] (LIB_STANDARD): Don't define.

Fri Oct  9 01:08:36 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* m-ibmrs6000.h (PTY_ITERATION, etc.): Definitions deleted.
	(SPECIFY_X11R4): Don't define if already defined.
	* s-aix3-2.h (SPECIFY_X11R4): Defined.

	* m-mips4.h: If __GNUC__, undef LINKER.
	Change LD_SWITCH_MACHINE to pass switches via GCC; add -g.

	* m-pyrmips.h: New file.

Tue Oct  6 00:54:20 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* fileio.c (directory_file_name): Don't clobber the envvar
	when handling top-level rooted dir.

	* link.com: Fix the code that tests which compiler was used.

	* m-ibmps2-aix.h [USG_SHARED_LIBRARIES]: Define ORDINARY_LINK.
	Undef LIB_STANDARD.  Modify LD_SWITCH_MACHINE.

	* ymakefile (LIB_STANDARD): If ORDINARY_LINK, default this to empty.

	* emacs.c (main) [NeXT]: Call malloc_jumpstart.

	* unexnext.c: New file.
	* m-next.h, s-mach2.h: New files.

Sun Oct  4 19:18:25 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* s-sco.h (HAVE_TIMEVAL): Turned off.

Sat Oct  3 00:22:57 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* ymakefile (STARTFILES): Do use pre-crt0.o even if ORDINARY_LINK.
	* emacs.c: Don't define __main, etc., if ORDINARY_LINK.

	* s-sunos4-0.h, s-sunos4-1.h (LD_SWITCH_SYSTEM):
	If GCC 2, use -static instead of -Bstatic.

Fri Oct  2 02:27:39 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* unexmips.c (mark_x): Declare static.

	* callint.c (Fcall_interactively):
	Cast to unsigned char when setting `string'.

Thu Oct  1 20:41:26 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* s-hpux7.h (NO_X_DESTROY_DATABASE): Defined.
	* s-hpux8.h (NO_X_DESTROY_DATABASE): Undef it.
	* x11term.c (XInitWindow): Add NO_X_DESTROY_DATABASE conditional.

	* process.c (Fopen_network_stream): Use -1, not INADDR_NONE.

Mon Sep 21 01:45:34 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* alloc.c (mark_object): Avoid car-recursion in some common cases.

Sun Sep 20 15:02:57 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* emacs.c (__do_clobal_ctors, __main): Defined.
	(__CTOR_LIST__, __DTOR_LIST__): Add 0 as second elt.

	* getpagesize.h: If POSIX, include unistd.h and use sysconf.

	* s-sol2.h: New file.

	* fileio.c: Don't include sys/dir.h.

	* s-usg5-4.h (LIBS_SYSTEM): Move non-default libraries here.
	(LIB_STANDARD, START_FILES): Deleted.
	(ORDINARY_LINK): Defined.

	* ymakefile [ORDINARY_LINK]: Default LD to $(CC)
	and make START_FILES and LIB_STANDARD empty.
	(C_SWITCH_X_MACHINE, C_SWITCH_X_SYSTEM): New macros, default empty.
	(CFLAGS): Use them.

Thu Sep 17 18:49:39 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* ymakefile (LIBX): Don't use -loldX.

Sat Sep 12 03:20:22 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* s-esix5r4.h (LIB_X11_LIB): Use -lX11, don't specify lib file name.
	(LIB_STANDARD): Defined.
	(BSTRING): Defined.
	(C_SWITCH_SYSTEM): Deleted; we define BSTRING directly.

	* sysdep.c (init_sys_modes): Handle VDSUSP like V_DSUSP.
	Use CDISABLE, not CDEL.
	Turn off IEXTEN if it exists.
	(CDISABLE): New macro; may be defined from CDEL.

	* syntax.c (syntax_spec_code): Make elts unsigned.

Thu Sep 10 03:48:18 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* s-aix3-1.h (HAVE_GETHOSTNAME): Defined.

Mon Aug 31 13:57:44 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* emacs.c (__do_global_ctors, __do_global_ctors_aux): New dummy fns.
	(__CTOR_LIST__, __DTOR_LIST__): New dummy variables.

Fri Aug 28 22:30:25 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* unexmips.c (unexec): Allow sectins in any order.
	Adjust addresses of rdata section as well as data section.

Tue Aug 25 17:59:29 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* m-intel386.h [J386BSD] (LOAD_AVE_TYPE, LOAD_AVE_CVT): Defined.

	* s-386bsd.h: New file.

Fri Aug 21 22:50:34 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* process.c (WCOREDUMP): Define only if not defined.
	(create_process) [HAVE_SETSID]: Use TIOCSCTTY if exists.

Tue Aug 11 17:29:22 1992  Roland McGrath  (roland@geech.gnu.ai.mit.edu)

	* x11term.c (db, db2): Don't initialize, as it breaks dumping.

Fri Aug  7 19:38:28 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* vms-pwd.h: Renamed from pwd.h.
	* editfns.c, fileio.c, sysdep.c, filelock.c: #includes changed.

Wed Aug  5 00:47:16 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* m-delta.h (SIGNALS_VIA_CHARACTERS): Defined.

	* process.c (process_send_signal): Refer to SIGTSTP only if defined.

Tue Jul 28 12:39:58 MET 1992  Francesco Potorti`  (pot@cnuce.cnr.IT)

	* m-delta.h: Added #define mot_delta for alloca.s to recognise it.
	(CLASH_DETECTION): Defined, since now OK with short filenames.
	(LOAD_AVE_TYPE): Deleted.
	(C_ALLOCA): Deleted; new alloca.s should work.
	(KERNEL_FILE): Defined.
	(sigsetmask): Add #undef, since -lbsd supplies sigsetmask.
	(SYSV_SYSTEM_DIR, HAVE_CLOSEDIR): Defined.
	(BSTRING, HAVE_DUP2): Defined.
	(LIBS_SYSTEM): Use -lbsd here,
	(LIB_STANDARD): not here (deleted).
	(HAVE_X_WINDOWS): Deleted--X is not standard.
	(USG_SYS_TIME): Defined.
	(BAT68K): Deleted; replaced by USG_SYS_TIME.

Mon Jul 27 15:59:29 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* s-isc2-2.h (HAVE_SOCKETS, HAVE_SELECT): Defined.
	* s-isc3-0.h: Instead of here.

Fri Jul 24 15:28:51 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* dispnew.c (remake_screen_structures): Update echo_area_contents
	along with message_buf.
	* dispextern.h (echo_area_contents): Declare it.

	* xdisp.c (display_text_line): Init p1prev as 0.  Test at end.

Sun Jul 19 14:00:40 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* process.c (allocate_pty): Wait until we fail to open three ptys
	in a row before concluding that we've reached the end of the ptys.

Sat Jul 18 15:21:19 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* unexec.c (mark_x): Return 0 on success, -1 on failure.
	(unexec): Return what mark_x returns.

Mon Jul 13 23:04:30 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* x11term.c: (x_term_init): Use black_color and white_color
	for color names that correspond to preallocated pixel values.
	(x_term_init, XFlipColor): Handle inverse video for mous_color
	and curs_color by swapping between fore_color and back_color.
	* x11fns.c (Fx_set_*_color): Use black_color and white_color.
	Free the old color if and if it was allocated.
	Free the old color name as well.
	(x_set_cursor_colors): Use black_color and white_color.

Sat Jul 11 14:18:56 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* fns.c, callproc.c: Doc fix.

Fri Jul 10 13:45:51 1992  Jody Winston  (jody@shell.com)

	* x11term.c (XInitWindow): Free databases from XrmGetStringDatabase.

Tue Jul  7 11:22:17 1992  Jim Blandy  (jimb@pogo.cs.oberlin.edu)

	* regex.c. (re_compile_pattern): The temporary variable used when
	applying the translation map to character sets should be an
	unsigned char, not a char.

Mon Jul  6 17:19:48 1992  Roland McGrath  (roland@churchy.gnu.ai.mit.edu)

	* x11fns.c: Move lisp.h and window.h and undef NULL after all other
	includes.

Sun Jul  5 17:48:46 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* s-isc3-0.h: New file.

Sat Jun 27 19:08:06 1992  Jim Blandy  (jimb@pogo.cs.oberlin.edu)

	* regex.c (re_compile_pattern): Apply the translation map to
	contents of character sets, too.

Thu Jun 25 14:07:39 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* sysdep.c: On dgux, undef _BSD_TTY_FLAVOR before including sgtty.h.

	* window.c (scroll_command): If context lines exceed window
	height, scroll by one line.

Mon Jun 22 21:38:39 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* m-targon31.h (SEGMENT_MASK): Defined.
	(NO_REMAP): Deleted.
	(HAVE_PTYS, HAVE_SOCKETS, HAVE_SYSVIPC, BSTRING): Defined.
	[__GNUC__] (SYSTEM_MALLOC, HAVE_ALLOCA, alloca): Defined.

	* syntax.h (SYNTAX, SYNTAX_MATCH, SYNTAX_COMSTART_FIRST, etc.)
	Cast character to unsigned char before indexing.

Fri Jun 12 15:36:17 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* s-dgux4-31.h: New file.

Fri Jun 12 05:37:39 1992  Jim Blandy  (jimb@pogo.cs.oberlin.edu)

	* xdisp.c (display_echo_area_contents): After displaying
	echo_area_contents on the first line of the minibuffer window,
	display blank lines on all the other lines of the window.

Thu Jun 11 11:51:07 1992  Paul Eggert  (eggert@twinsun.com)

	* callproc.c (Fcall_process_region): Return Fcall_process's status.

Wed Jun 10 16:45:25 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* sysdep.c (sys_signal): Fix erroneous name for sigaction.

Wed May 27 23:41:59 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* m-ibmrs6000.h (PTY_ITERATION, PTY_NAME_SPRINTF): Defined.
	(PTY_TTY_NAME_SPRINTF): Defined.

Sat May 23 22:07:04 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* sink11.h, sink11mask.h: Use unsigned char to avoid warnings.

Thu May 21 16:34:56 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* alloca.c: Make symlink to master copy.

Mon May 18 22:04:35 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* dispnew.c (Fding): If have arg, don't end a keyboard macro.

Sun May 17 02:57:17 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* keyboard.c (Fdiscard_input): Clear Vquit_flag to nil.

Sat May 16 00:47:36 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* Use cursor color for hollow cursors.
	* x11fns.c (Fx_set_cursor_color, Fx_set_background_color):
	Modify XXgc_curs_rev.
	* x11term.c (CursorToggle): Use XXgc_curs_rev.
	(XNewFont, XFlipColor, XInitWindow): Update XXgc_curs_rev.

	* x11fns.c (Fx_set_background_color, Fx_set_foreground_color):
	(Fx_set_border_color, Fx_set_cursor_color): Free old color.

Thu May 14 22:21:46 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* callproc.c (Fcall_process): Fix one-off testing if args[3] is valid.

Wed May 13 15:39:38 1992  Jim Blandy  (jimb@wookumz.gnu.ai.mit.edu)

	* buffer.c (init_buffer_once): Don't disable undo for *scratch*
	buffer here.  There is no good symmetrical place to re-enable it,
	although garbage collection used to do so.  Do it in
	../lisp/loadup.el instead.

Tue May 12 23:54:33 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* fileio.c: Include config.h first thing.

	* process.c (wait_reading_process_input):
	Make C-g really quit in sit-for case.
	* keyboard.c (clear_input_pending): New subroutine.

	* ymakefile (LD_SWITCH_SYSTEM): Don't use -X with GCC.

Tue May 12 16:02:15 1992  Jim Blandy  (jimb@wookumz.gnu.ai.mit.edu)

	* alloc.c (Fgarbage_collect): Don't call truncate_undo_list on
	buffers whose undo list is t.

Thu May  7 18:47:14 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* m-seq386.h: Tentatively make this the same as m-sequent.h.

Tue May  5 11:30:44 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* m-tad68k (SECTION_ALIGNMENT): Increase to 256k.
	(NBPC, HAVE_RANDOM): Defined.

Thu Apr 30 18:17:26 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* s-sco.h (PTY_NAME_SPRINTF, PTY_TTY_NAME_SPRINTF): Defined.

Tue Apr 28 19:55:01 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* s-irix4-0.h: Turn on pty stuff.  Declare getpty only ifdef emacs.
	(WNOHANG): Defined.

Tue Apr 28 15:39:53 1992  Jim Blandy  (jimb@wookumz.gnu.ai.mit.edu)

	* syntax.c (Fmodify_syntax_entry): Note that '-' is a synonym for
	' ' (both denote whitespace), that '\\' denotes the escape class,
	and that '/' denotes the character-quote class.  The description
	used to claim that '\\' denoted the character-quote class, and
	neglected to mention '-' and '/'.

Mon Apr 27 16:15:13 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* alloca.s [mot_delta]: Use `global', and a colon after the label.

Sat Apr 25 15:40:37 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* s-osf1.h: New file.
	* m-pmax.h [OSF1]: Undef C_ALLOCA, define HAVE_ALLOCA.

Wed Apr 22 19:19:37 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* s-sco.h (USG_SYS_TIME): Defined.
	(HAVE_SOCKETS, LIBS_SYSTEM, HAVE_GETTIMEOFDAY): Only if SCO_SOCKETS.

Tue Apr 21 10:44:59 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* ymakefile (x11term.o): Add gettime.h, emacssignal.h, xkeys-aix.h.

Mon Apr 20 15:13:34 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* s-sco.h (HAVE_TIMEVAL, HAVE_SELECT, HAVE_PTYS, HAVE_SOCKETS):
	(LIBS_SYSTEM, BSTRING, HAVE_GETTIMEOFDAY): Defined.

Sun Apr 19 13:12:22 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* m-seq386.h: New file.

Sun Apr 19 00:43:17 1992  Jim Blandy  (jimb@wookumz.gnu.ai.mit.edu)

	* fileio.c (directory_file_name): Check slen before fetching dst[slen].

Sat Apr 18 11:59:13 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* fileio.c: Move HAVE_TIMEVAL and HPUX_NET conds above lisp.h include.

	* indent.c (compute_motion): Fix skipping invis lines and
	truncation at right margin.

Fri Apr 17 11:33:50 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* dispnew.c (direct_output_forward_char): Handle edges of window.

	* filelock.c (lock_superlock, lock_file_1): Handle NO_FCHMOD.
	* m-dpx2.h (fchmod): Deleted.
	(NO_FCHMOD): Defined.

	* ymakefile (x11term.o, dired.o, UNEXEC): Add or fix deps.

Fri Apr 17 05:44:46 1992  Jim Blandy  (jimb@wookumz.gnu.ai.mit.edu)

	* callint.c (Fcall_interactively): Check for quits when following
	function chain.

Wed Apr 15 00:34:05 1992  Jim Blandy  (jimb@pogo.cs.oberlin.edu)

	* callint.c (Fcall_interactively): When the interactive spec is
	a string, it may be relocated while reading the arguments.  To
	avoid this, make a copy of the spec to refer to, instead of
	using a pointer to the data of the spec string.

Fri Apr 10 15:13:49 1992  Jim Blandy  (jimb@wookumz.gnu.ai.mit.edu)

	* ymakefile (dispnew.o): Note that this depends on lisp.h.

Sat Apr  4 20:29:07 1992  Roland McGrath  (roland@churchy.gnu.ai.mit.edu)

	* indent.c (pos_tab_offset): Add missing ).

Mon Mar 30 01:02:12 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* s-irix4-0.h: Fix typo `#ifdef 0'.

Sun Mar 29 21:02:14 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* s-dgux.h: Change #if 0 to #ifndef COFF.
	Don't define COFF if ELF is defined.
	[not COFF] (C_COMPILER, LINKER, MAKE_COMMAND): New defs.

	* process.c (process_send_signal): If SIGNALS_VIA_CHARACTERS,
	disable the alternative code for using characters.

Sat Mar 28 15:41:38 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* regex.c (re_match_2): Check for exactly -1 in regend.

Fri Mar 27 02:29:16 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* data.c (arith_driver, Frem): Detect division by 0 by hand.
	(arith_error): Call Fsignal again if it returns.

	* indent.c (pos_tab_offset): Handle windows not ending at right margin.
	* xdisp.c (try_window, try_window_id, display_text_line): Likewise.

Mon Mar 23 22:09:00 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* keyboard.c (Fexecute_extended_command): Enlarge and write
	this_command_keys properly.

	* filelock.c (CREATE_LOCK_FILE_NAME): New macro; two definitions.
	(SHORT_FILE_NAMES): New parameter macro.
	(lock_file, unlock_file, Ffile_locked_p): Use it.
	(fill_in_lock_short_file_name): New function.

Sun Mar 22 23:10:01 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* process.c (Fopen_network_stream): Try host number first,
	then host name.

	* callproc.c, data.c, dispnew.c, emacs.c, keyboard.c, malloc.c:
	* process.c, sysdep.c: Include sys/types.h before signal.h.
	* s-isc2-2.h: Don't include sys/types.h.

	* filetypes.h: New file.
	* dired.c, fileio.c, filelock.c, filemode.c: Include filetypes.h.
	* lread.c, sysdep.c: Likewise.

Fri Mar 20 13:56:32 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* m-delta.h (mot_delta): New macro.
	* alloca.s [mot_delta]: Treat this almost like hp9000s300.

Thu Mar 12 15:34:51 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* process.c (process_send_signal): Test SIGNALS_VIA_CHARACTERS.
	* s-irix3-3.h, s-isc2-2.h: Define SIGNALS_VIA_CHARACTERS.
	* s-isc2-2.h: Include sys/types.h.
	(TIOCGPGRP): Defined.

Wed Mar 11 00:05:25 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* window.c: Doc fix.

	* sysdep.c (OSPEED, SETOSPEED): Define only if undefined.

	* process.c (process_send_signal): Fix up pfa conditional.

Tue Mar 10 11:14:11 1992  Jim Blandy  (jimb@pogo.cs.oberlin.edu)

	* xdisp.c (redisplay_window): If the start position is forced,
	constrain in to be within the visible range.

Sat Mar  7 02:01:00 1992  Chris Hanson  (cph@klia.ai.mit.edu)

	* process.c (create_process): Don't execute SETUP_SLAVE_PTY or
	child_setup_tty if using pipes.  System V using STREAMS gets
	errors when this is done.

	* s-newsos5.h: New file for Sony NEWS-OS release 5.
	* m-mips.h [NEWSOS5]: Changes so this file can be used with it.

	* m-mips.h (XUINT, XSET, XUNMARK): Add parentheses to eliminate
	warnings from GCC.  Reindent to fit in 80 columns.

Sat Mar  7 01:36:58 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* sysdep.c (rename) [__STDC__]: Make args match ANSI spec.

	* m-ibmrs6000.h (signal): Define, as in m-intel386.h.

	* dispnew.c (change_screen_size): Don't queue change if size is same.

Thu Mar  5 17:26:35 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* m-intel386.h [USG5_4] (C_ALLOCA): Defined.

	* unexmips.c (unexec): Use data_start, not DATA_START,
	setting data_section->s_scnptr.

	* ymakefile (LINKER): Define specially for GCC 2.

	* m-delta.h (LIB_STANDARD): Add -lbsd.
	(HAVE_TIMEVAL, HAVE_GETTIMEOFDAY, HAVE_SELECT, HAVE_SOCKETS):
	(BROKEN_FIONREAD, USE_UTIME, HAVE_X_WINDOWS): New macros.
	(LD_SWITCH_MACHINE): Deleted.

	* x11term.c (stringFuncVal): Handle function key 10.

	* x11term.c (XT_GetDefaults): Use CLASS with the cname.

	* m-iris4d.h (XUINT, XSET, XUNMARK): Add parens for clarity.

	* unexaix.c (unexec): Delete spurious semicolons from #ifdefs.
	(make_hdr, mark_x, copy_text_and_data, copy_sym): Add static
	forward decls.
	(unrelocate_symbols): Cast initial values of t_start and d_start.

	* hftctl.c: Include sys/uio.h.
	Declare hfskbd and hfqry static at first.

	* dispnew.c (direct_output_for_insert): Add parens around &&.

	* lisp.h (XINT): Add parens for clarity.

	* m-ibmrs6000.h (C_SWITCH_MACHINE): Value now empty.

	* s-usg5-4.h (SYSV_STREAMS): Defined.
	(HAVE_SOCKETS): Defined.  This is an experiment.

	* m-pfa50.h: New file.
	* unexec.c (adjust_lnnoptrs): Handle pfa like amdahl_uts.
	* process.c (create_process): Handle pfa like stride.
	(process_send_signal): Add pfa conditional.
	* sysdep.c [pfa]: Include sys/file.h.

	* emacs.c [USG5]: Don't include fcntl.h twice.

Tue Mar  3 17:37:46 1992  Chris Hanson  (cph at kleph)

	* unexec.c: Don't declare sbrk if compiling for HP-UX, because
	the correct declaration is already supplied by <unistd.h>.

Sat Feb 29 23:26:14 1992  Noah Friedman  (friedman@nutrimat.gnu.ai.mit.edu)

        * sysdep.c (get_system_name): use gethostname for USG systems if
          HAVE_GETHOSTNAME defined.
        * s-hpux7.h, s-irix3-3.h (HAVE_GETHOSTNAME): define it.

Tue Feb 18 14:01:01 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* Version 18.58 released.

	* process.c (create_process): Really don't use variable `sigchld'.

Sun Feb 16 00:40:47 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* fileio.c: Doc fix.

	* x11term.c: Define NULL if nec after all system headers.

Fri Feb 14 02:50:33 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* m-news-risc.h (LINKER): #undef it.

Thu Feb 13 17:54:46 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* x11term.c (XTflash): Wait just .15 sec.

	* process.c, sysdep.c: Don't include termio.h if NO_TERMIO.
	(TIOCGPGRP): If TRITON88, define as alias for FIOGETOWN.
	* m-triton88.h: New file.

Wed Feb 12 12:19:16 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* ymakefile ($(OLDXMENU)): If ln fails, use cp.

	* m-tek4300.h (tek4300): Don't define if defined already.

	* m-intel386.h (LIB_STANDARD): Add missing #endif.

Tue Feb 11 16:23:15 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* process.c (BROKEN_O_NONBLOCK): New parameter; undefine O_NONBLOCK.
	* m-pmax.h (BROKEN_O_NONBLOCK): Defined.
	* m-vax.h (BROKEN_O_NONBLOCK): Defined, if ultrix.

Mon Feb 10 21:14:38 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* data.c (Fset_default): Handle the case of mask < 0.

	* s-isc3-2.h: File deleted.  s-isc2-2.h does work for 3.2.

Sun Feb  9 23:25:05 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* undo.c (Fprimitive_undo): Use Finsert_before_markers.

Sat Feb  8 01:44:14 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* sysdep.c (child_setup_tty) [IRIS_4D]: Make sure we have VSWTCH char.

	* m-intel386.h (HAVE_ALLOCA): Inhibit if C_ALLOCA.
	(LIB_STANDARD): Alternate USG value if __GNUC__ or C_ALLOCA
	* s-sco.h (alloca): Define C_ALLOCA or define alloca as builtin.
	(BROKEN_TIOCWINSZ): Defined.

	* s-isc2-2.h (SIGTSTP): Don't #undef this.

	* process.c (PTY_OPEN): Handle new macro.

Fri Feb  7 23:07:58 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* fileio.c (Fmake_symbolic_link): If error, try deleting link name
	and then retry.  Read first arg, not second, as raw string.

Thu Feb  6 15:24:25 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* s-hpux7.h: Renamed from s-hpux.h.
	* s-hpux8.h: Include s-hpux7.h.

	* s-isc3-2.h: New file.

Wed Feb  5 19:39:21 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* gettime.h: On DPX2, include sys/time.h.

Tue Feb  4 01:03:05 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* s-sco.h (DONT_DEFINE_SIGNAL): Defined.

	* window.c (window_scroll): If NOERROR, return indication of failure.
	(Fscroll_other_window): Signal at end the error inhibited before.

	* s-aix3-2.h: New file.

Mon Feb  3 17:05:05 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* callproc.c (Fcall_process): Clear synch_process_* earlier.

	* x11term.c (XT_Set_Size_Hints) [not X11R4]: Turn off "old, broken"
	code to set min_width and min_height fields.

	* x11term.c: Undo Jan 27 change.

	* m-intel860.h: New file.

Sun Feb  2 16:49:11 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* sysdep.c [_SEQUENT_]: Include stropts.h.

	* sysdep.c, process.c, x11term.c, keyboard.c: Fix comments on #endif.

Sat Feb  1 14:21:31 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* x11term.c (x_init_1): No args for setpgrp if USG.

	* m-iris4d.h (C_SWITCH_MACHINE): Deleted.

	* dispnew.c (remake_screen_structures): Put spaces in message_buf.
	(make_screen_structure): Fill with spaces even if EMPTY.

	* x11term.c (XT_Set_Size_Hints): Handle window gravity.

Fri Jan 31 04:15:12 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* Makefile (distclean): Depend on clean; delete redundant stuff.

	* x11term.c (XT_Set_Size_Hints): Test X11R4, not PBaseSize.
	(X11R4): Default based on PBaseSize or SPECIFY_X11R4.
	(SPECIFY_X11R4): New parameter macro.
	* m-ibmrs6000.h (SPECIFY_X11R4): Defined.

	* ymakefile (LIB_GCC, GNULIB_VAR): Handle GCC 2.

	* s-hpux8.h (OLDXMENU_OPTIONS): New definition.

	* s-sunos4-1.h (C_SWITCH_SYSTEM): Delete leading space.

	* s-sunos4-0.h (SYSTEM_MALLOC): Deleted.

Thu Jan 30 01:44:47 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* malloc.c (malloc): If SUNOS_LOCALTIME_BUG, get at least 16 bytes.

	* dispnew.c (update_line): Prevent nlen from getting <0.

	* x11term.c (XT_Set_Size_Hints): Test PBaseSize, not XICCC.

	* m-orion105.h (C_DEBUG_SWITCH, LIBS_DEBUG): Defs deleted.

Wed Jan 29 14:37:42 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* m-iris4d.h (C_SWITCH_MACHINE): New definition.

Tue Jan 28 00:46:18 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* fileio.c (Fwrite_region): Remove Alliant conditional.
	* crt0.c: Conditionals for ALLIANT_2800.
	* m-all2800.h: New file.
	* unexfx2800.c: New file.

	* m-mips4.h (C_DEBUG_SWITCH): Alternate defn for GCC.

	* sysdep.c [VMS] (sys_write): Special case for fixed-length
	with carriage-control characters.

	* s-isc2-2.h (NOMULTIPLEJOBS): Undef this.

Mon Jan 27 18:57:26 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* s-isc2-2.h (LIB_STANDARD): Add -lPW.

	* dispnew.c (update_line): ALLIANT patch to work around compiler bug.

	* lread.c (readevalloop): Make forward declaration static.

	* m-mips4.h (LD_SWITCH_MACHINE): Alternate definition if using GCC.

	* dispnew.c (update_screen): If force, don't call detect_input_pending.

	* x11term.c: #undef NULL before stdio.h.

	* dispnew.c (make_screen_structure): Fill lines with spaces to start.

	* s-hpux8.h (NO_SIOCTL_H): Defined.

Sun Jan 26 00:33:35 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* dispnew.c: Fix doc string of visible-bell.

	* m-mips.h (C_SWITCH_MACHINE): Defined, instead of C_SWITCH_SYSTEM.
	(LINKER): Defined, if BSD.

Sat Jan 25 16:01:00 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* fileio.c (Fexpand_file_name): When removing / from end of newdir,
	don't change `/' to `'.

	* dired.c (file_name_completion_stat): Try stat, then lstat.

	* unexelf.c: Fix typo in last change.

	* fileio.c (Finsert_file_contents) [AIX]: Don't open mpx files.

	* fileio.c (Fmake_symbolic_link): Use `s' to read second arg.

	* dispnew.c: Include errno.h.

Thu Jan 23 14:03:44 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* s-usg5-4.h (LIBX10_SYSTEM): Add #undef.
	(GNULIB): Definition deleted--done in ymakefile.
	(LIB_STANDARD): Don't use GNULIB.
	(HAVE_TCATTR): Defined.

	* lisp.h (XINT): Add extra parens.

	* unexelf.c: Handle rounding of section boundaries.
	(round_up): New function.

Wed Jan 22 22:32:28 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* m-tad68.h: New file.

Tue Jan 21 21:49:43 1992    (Eric Youngdale at youngdale@v6550c.nrl.navy.mil)

	* sysdep.c (sys_access) [VMS]: Fix bug whereby the default rather 
	than the actual privileges were used to determine if we have
	file access.

Mon Jan 20 12:41:27 1992    (Eric Youngdale at youngdale@v6550c.nrl.navy.mil)

	* fileio.c (Finsert_file_contents) [VMS]: Adjust st_size
	if file has fixed length records and implied carriage control.

Sun Jan 19 23:39:10 1992    (Eric Youngdale at youngdale@v6550c.nrl.navy.mil)

	* compile.com: Delete useless object file generated when sensing
	the presence of a C compiler.  Prevent user from seeing error 
	message when sensing C compiler.

Sun Jan 19 11:29:00 1992    (Eric Youngdale at youngdale@v6550c.nrl.navy.mil)

	* fileio.c (file_name_as_directory): Cast result of `index'.
	(directory_file_name): Likewise.
	* sysdep.c (getpwnam): Cast result of egetenv.

	* vmsfns.c: Don't include syidef.h if using GCC.

Sat Jan 18 23:16:41 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* Makefile (xmakefile): Write formfeed and tab literally.

Sat Jan 18 13:41:54 1992    (Eric Youngdale at youngdale@v6550c.nrl.navy.mil)

	* compile.com: Automatically use whichever C compiler is installed.

Fri Jan 17 15:43:29 1992  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* process.c (process_send_signal): Undo Nov 23 change.

	* process.c (wait_reading_process_input): Use timeout_subtract.
	* x11term.c (XTflash): Likewise.
	* dispnew.c (Fsleep_for): Likewise.
	(timeout_subtract): New function to subtract struct timeval.

Thu Jan 16 01:47:48 1992  Richard Stallman  (rms at mole.gnu.ai.mit.edu)

	* m-delta88.h: New file.

	* window.c (window_scroll): New arg `noerror'.
	(scroll_command, Fscroll_other_window): Pass that arg.

	* indent.c (compute_motion): Don't pack vpos and hpos into one int;
	use separate variables hpos/vpos and prev_hpos/prev_vpos.
	(vmotion): Use largest int as tovpos arg to compute_motion.

Wed Jan 15 03:39:37 1992  Richard Stallman  (rms at mole.gnu.ai.mit.edu)

	* x11term.c (XT_GetDefaults): Use Xrm functions, then XGetDefault.
	Include Xresource.h.

	* callproc.c (Fcall_process): Get return status from
	synch_process_death and synch_process_retcode.
	* process.c (sigchld_handler): Set those vars.

Sun Jan 12 17:05:53 1992  Richard Stallman  (rms at mole.gnu.ai.mit.edu)

	* ymakefile (OLDXMENU_OPTIONS): New macro, used compiling oldxmenu.
	* s-sunos4-1.h (OLDXMENU_OPTIONS): New definition.
	(LD_SWITCH_SYSTEM, C_SWITCH_SYSTEM): New definitions.
	* s-sunos4.h: File deleted.

Fri Jan 10 15:56:11 1992  Richard Stallman  (rms at mole.gnu.ai.mit.edu)

	* m-hp9000s800.h (S_IFLNK): Don't #undef this.

	* s-hpux.h (CLASH_DETECTION): Define it.

Thu Jan  9 00:25:15 1992  Richard Stallman  (rms at mole.gnu.ai.mit.edu)

	* sysdep.c, process.c: Include sys/termios.h if NEED_TERMIOS.

Tue Jan  7 23:38:33 1992  Richard Stallman  (rms at mole.gnu.ai.mit.edu)

	* x11term.c (XTflash): Wait 1/4 sec even if interrupts come.

	* process.c: Doc fix.

Wed Jan  1 02:12:50 1992  Richard Stallman  (rms at mole.gnu.ai.mit.edu)

	* window.c (init_window_once): Call make_window with no args.

	* keyboard.c (command_loop_1): Move label directly_done.

Tue Dec 31 15:53:00 1991  Richard Stallman  (rms at mole.gnu.ai.mit.edu)

	* emacssignal.h (signal_full_mask, signal_empty_mask): Vars renamed.
	(sigmask): Copy from SIGEMPTYMASK.
	(sys_sigpause): Argument is a mask.
	(SIGFULLMASK, sigunblock, sys_sigdel): New non-POSIX definitions.
	* sysdep.c (sigunblock): Definition removed.
	(wait_for_termination): Change call to sigpause.
	(signal_full_mask, signal_empty_mask): Vars renamed.
	(signal_handler_t): Add missing `typedef'.

	* s-dgux.h: Remove MAKING_MAKEFILE conditional.
	Don't include signal.h.
	(C_COMPILER, LINKER, MAKE_COMMAND): New definitions.
	(LD_SWITCH_SYSTEM, START_FILES, LIBS_SYSTEM): New definitions.

	* ymakefile (CC, MAKE): Set these variables from optional macros.
	Change all uses of `make' to ${MAKE}.

	* term.c (term_init): Change buffer size and malloc'd size to 4092.

Fri Dec 13 17:22:42 1991  Richard Stallman  (rms at mole.gnu.ai.mit.edu)

	* s-isc2-2.h (LIBS_SYSTEM): Defined.

Mon Dec  9 20:50:53 1991  Richard Stallman  (rms at mole.gnu.ai.mit.edu)

	* process.c (Fopen_network_stream): Handle EINTR from connect,
	but turn off interrupts anyway.

	* emacs.c (main): Do tzset if HAVE_TZSET.
	* s-sunos4.h: Define HAVE_TZSET.

Sat Dec  7 21:00:21 1991  Richard Stallman  (rms at mole.gnu.ai.mit.edu)

	* s-aix3-1.h (FIRST_PTY_LETTER): Deleted.
	(PTY_ITERATION, PTY_NAME_SPRINTF, PTY_TTY_NAME_SPRINTF): New macros.

Fri Dec  6 15:14:18 1991  Richard Stallman  (rms at mole.gnu.ai.mit.edu)

	* minibuf.c (read_minibuf_unwind): Clear readonlyness of minibuffer.

Tue Dec  3 22:07:36 1991  Richard Stallman  (rms at mole.gnu.ai.mit.edu)

	* dispnew.c (change_screen_size_1): New arg FORCE forces redisplay.
	(change_screen_size): Likewise.  All callers changed.
	(update_screen): Do the real work.
	* x11term.c (internal_socket_read): Pass 1 for new arg.

Mon Dec  2 23:14:29 1991  Richard Stallman  (rms at mole.gnu.ai.mit.edu)

	* lisp.h: Turn text after #endif, #else into real comment.

Thu Nov 28 01:37:13 1991  Richard Stallman  (rms at mole.gnu.ai.mit.edu)

	* m-ibmps2-aix.h (HAVE_SETSID, HAVE_TCATTR): Defined.
	(LIB_STANDARD): Remove -lbsd and -lrts.
	Suggested by tranle@intellicorp.com.

	* sysdep.c (child_setup_tty) [AIX]: If process_send_signal will use 
	chars, make sure we have chars for VQUIT and VINTR.

	* lisp.h (DEFVARPERBUFFER, DEFVAR_PER_BUFFER):
	Don't omit 3d arg to defvar_per_buffer.

Sat Nov 23 16:51:13 1991  Richard Stallman  (rms at mole.gnu.ai.mit.edu)

	* emacs.c (main) [BSD4_3]: Call tzset.

	* process.c (process_send_signal): On AIX, don't try sending character.

Wed Nov 20 21:46:18 1991  Richard Stallman  (rms at mole.gnu.ai.mit.edu)

	* m-convex.h (XINT): Use submacros VSIGNBIT, VALLBITS.

Tue Nov 19 16:11:57 1991  Richard Stallman  (rms at mole.gnu.ai.mit.edu)

	* config.h-dist (X11): Define only if HAVE_X_WINDOWS.

	* s-irix3-3.h (IRIX): Defined.
	* sysdep.c (get_system_name): Special code for IRIX.

Sat Nov 16 16:53:44 1991  Richard Stallman  (rms at mole.gnu.ai.mit.edu)

	* s-irix3-3.h (HAVE_SETSID): Define here.
	* s-irix4-0.h: Instead of here.

	* process.c (process_send_signal): New code for Iris.

Thu Nov 14 18:01:56 1991  Jim Blandy  (jimb at wombat.gnu.ai.mit.edu)

        * eval.c (specbind): Check that the thing being bound is a symbol.
        (funcall_lambda): Signal an invalid-function error if the
        arguments are not all symbols.

Fri Oct 25 14:53:40 1991  Richard Stallman  (rms at mole.gnu.ai.mit.edu)

	* xdisp.c (redisplay): Properly compute TAB_OFFSET for compute_motion.

	* s-irix4-0.h: New file.

	* ymakefile: Fix comments on #endifs.

	* unexmips.c (unexec): Get rid of error check about mismatch
	in number of sections.

	* s-irix3-3.h (C_ALLOCA): Defined.

Tue Oct 22 01:41:09 1991  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* process.c (wait_reading_process_input): Redisplay if screen_garbaged.
	Call do_pending_window_change first.
	Include dispextern.h.
	* ymakefile (process.o): Added dependency.

Mon Oct 21 23:05:15 1991  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* buffer.c: Doc fix. 

Sun Oct 20 18:41:06 1991  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* x11term.c (XTflash): Flash just center quarter of window.

Sat Oct 19 11:39:03 1991  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* process.c (create_process): Set bit in input_wait_mask before fork,
	so sigchld_handler can clear it properly at any time.

	* cmds.c (Fforward_line): Moving nowhere at eob after non-newline
	should return 1, not 0.

	* s-hpux.h (LD_SWITCH_SYSTEM): Defn deleted.
	* s-hpux8.h (LD_SWITCH_SYSTEM): Move -L here.
	(LIB_X11_LIB): Moved from here.  Definition deleted.

	* m-intel386.h (signal): Optionally don't define it.
	* s-isc2-2.h (DONT_DEFINE_SIGNAL): Define this.

	* x11term.c (internal_socket_read):
	Do window size change immediately if currently waiting for input.
	* dispextern.h (waiting_for_input): Declared here.

Sun Oct 13 05:20:50 1991  Richard Stallman  (rms at mole.gnu.ai.mit.edu)

	* config.h-dist (PURESIZE): Increase to 120000 if no X.

	* m-intel386.h: Fix typo in #endif.

	* ymakefile: Use C style comment, not #.

Sat Oct 12 14:34:26 1991  Richard Stallman  (rms at mole.gnu.ai.mit.edu)

	* x11term.c (internal_socket_read):
	Threshold for real size change was off by one.

	* emacs.c (main) [AIX]: Handle SIGURG, not SIGIOINT.

Tue Oct  8 00:43:19 1991  Richard Stallman  (rms at mole.gnu.ai.mit.edu)

	* x11term.h: Never include X10.h.
	* xmenu.c: Include it here.

Tue Oct  8 00:07:47 1991  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* search.c (syms_of_search): Set re_max_failures here.
	(compile_pattern): Not here.

Sun Oct  6 14:47:52 1991  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* config.h-dist (X11): Define this by default.

Sat Oct  5 14:00:22 1991  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* search.c (compile_pattern): Use bigger than default re_max_failures.

	* x11fns.c: Move lisp.h and window.h later; undef NULL just before.

Tue Sep 24 03:20:07 1991  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* alloca.c: Test __STDC__, not X3J11.
	Do nothing if alloca is defined as a macro.

Sun Sep 22 03:39:58 1991  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* editfns.c (Ffollowing_char): Really return 0 at eob.

	* m-tandem-s2.h: Near complete rewrite.

Sun Sep 15 17:36:02 1991  Richard Stallman  (rms at mole.gnu.ai.mit.edu)

	* ymakefile (paths.h, config.h): Never copy, always fail.

Sat Sep 14 02:08:39 1991  Richard Stallman  (rms@mole.gnu.ai.mit.edu)

	* dired.c (file_name_completion): Copy two improvements in ignoring
	case from Ftry_completion: of inexact matches, prefer one that doesn't
	change the case, and preserve user's input case whenever we can't
	add any more text.

	* process.c (create_process): Give subtty its permanent value
	right from the start.  Duplicate the descriptor.
	Handle system call failures opening pty or pipes.

	* sysdep.c (tcgetattr): Just one definition, if not HAVE_TCATTR.
	[HAVE_TERMIO]: Coalesce duplicate definition and include.

	* process.c (close_process_descs): Close subtty of proc if open.

	* x11fns.c (Fcoordinates_in_window_p): Don't consider minibuf prompt.
	That's now in x-mouse.el.

Wed Sep 11 20:44:27 1991  Richard Stallman  (rms at mole.gnu.ai.mit.edu)

	* ymakefile (paths.h, config.h): Don't use sh -c.  Get rid of @.

Tue Sep 10 23:18:13 1991  Richard Stallman  (rms at mole.gnu.ai.mit.edu)

	* ymakefile (paths.h, config.h): Use explicit file names, not $?, $@.

Mon Sep  9 20:32:35 1991  Richard Stallman  (rms at mole.gnu.ai.mit.edu)

	* crt0.c (start1): Declare static before first use.

	* lread.c (read1): Don't accept integer containing quoted chars.

Sun Sep  8 22:13:50 1991  Richard Stallman  (rms at mole.gnu.ai.mit.edu)

	* eval.c (Feval): Don't allow return without correcting backtrace_list.
	(Ffuncall): Likewise.

Tue Sep  3 20:49:28 1991  Richard Stallman  (rms at mole.gnu.ai.mit.edu)

	* sysdep.c (wait_for_termination): Use sleep loop instead of `pause'.

Mon Sep  2 14:57:52 1991  Richard Stallman  (rms at mole.gnu.ai.mit.edu)

	* search.c (Fstring_match, search_buffer): Real Lisp error on overflow.

	* lread.c (map_obarray): Don't die if obarray contains non-symbol.

Sat Aug 31 14:38:51 1991  Richard Stallman  (rms at mole.gnu.ai.mit.edu)

	* sysdep.c (wait_for_termination): Make use of sysv sigpause.
	* s-usg5-3.h (HAVE_SYSV_SIGPAUSE): Defined.

	* emacs.c (main): Ignore SIGDANGER on aix.

Thu Aug 29 01:29:47 1991  Richard Stallman  (rms at mole.gnu.ai.mit.edu)

	* editfns.c: Doc fix.

Mon Aug 26 22:00:16 1991  Richard Stallman  (rms at mole.gnu.ai.mit.edu)

	* data.c (Fset): When this buffer sees default value,
	thoroughly set the default value right away.

Sat Aug 24 15:07:16 1991  Richard Stallman  (rms at mole.gnu.ai.mit.edu)

	* callproc.c: Doc fix.

	* keyboard.c (Fopen_dribble_file): Handle closing the file.

Thu Aug 22 01:37:40 1991  Richard Stallman  (rms at mole.gnu.ai.mit.edu)

	* commands.h (quit_char): Declare it.
	* minibuf.c (temp_echo_area_contents): Use that var.

Fri Aug 16 16:04:22 1991  Richard Stallman  (rms at mole.gnu.ai.mit.edu)

	* s-hpux.h (LD_SWITCH_SYSTEM): Defined.
	* fileio.c: Changed a HPUX conditional to HPUX_NET.

Mon Aug 12 21:29:05 1991  Richard Stallman  (rms at mole.gnu.ai.mit.edu)

	* abbrev.c (Fexpand_abbrev): Don't let capitalization go past point.

Sat Aug 10 15:16:02 1991  Richard Stallman  (rms at mole.gnu.ai.mit.edu)

	* sysdep.c (sys_suspend): Don't use & before array name.

	* sysdep.c [BROKEN_FIONREAD]: Undefine FASYNC.

	* m-tandem-s2.h (START_FILES, LIB_STANDARD): Added.

Fri Aug  2 14:01:24 1991  Richard Stallman  (rms at mole.gnu.ai.mit.edu)

	* s-aix3-1.h (HAVE_TCATTR):  Defined.
	* sysdep.c (HAVE_TERMIO definitions):  Add HAVE_TCATTR inside IBMR2AIX.

Thu Aug  1 18:38:29 1991  Roland McGrath  (roland@churchy.gnu.ai.mit.edu)

	* fileio.c (Fexpand_file_name): Avoid doing strlen (0).

Thu Aug  1 12:31:38 1991  Richard Stallman  (rms at mole.gnu.ai.mit.edu)

	* emacs.c (main): Add SIGIO conditional within AIX conditional.

	* xdisp.c (try_window_id): Compute proper position for screen bottom
	when all changes are below the screen.
	When first computing bp, don't go more than HEIGHT + 1 lines.

Tue Jul 30 21:50:59 1991  Richard Stallman  (rms at mole.gnu.ai.mit.edu)

	* x11fns.c (Fx_proc_mouse_event): Clear out shift-lock bit.

Sat Jul 27 13:43:29 1991  Richard Stallman  (rms at mole.gnu.ai.mit.edu)

	* window.c (init_window_once): Increment window_select_count.

	* keymap.c (Fkeymapp): Doc fix.
	(Fcopy_keymap): Don't recursively copy keymaps inside symbols.

Mon Jul 22 21:26:00 1991  Richard Stallman  (rms at mole.gnu.ai.mit.edu)

	* s-dgux.h, m-aviion.h: New files.

	* emacs.c (main) [POSIX_SIGNALS]: Call init_signal.

	* fns.c (Fload_average) [DGUX]: Add alternate code.

	* sysdep.c [DGUX] (sys_siglist): New variable.

	* sysdep.c (_sobuf): Unsigned chars if DGUX.

	* sysdep.c (init_signals, sys_signal, sys_sigpause): New functions.
	(sys_sigblock, sys_sigunblock, sys_sigsetmask): New functions.

	* emacssignal.h: New file.
	* data.c, keyboard.c, process.c, sysdep.c, x11term.h: Include it.
	* data.c (arith_error): Use SIGEMPTYMASK.
	* keyboard.c (sigfree, sigunblockx): Use SIGEMPTYMASK.
	(get_input_pending): Use SIGMASKTYPE.
	* keyboard.c (sigholdx, sigblockx): Use sigmask.
	* process.c (create_process): Use sigmask.
	* sysdep.c (wait_for_termination): Use them.
	[FASYNC] (request_sigio): Use sigunblock.
	* x11term.h (BLOCK_INPUT_DECLARE): Use SIGMASKTYPE.
	* x11term.c (sigunblockx): Use SIGEMPTYMASK.

	* process.h (subtty): New slot.
	* process.c (create_process): Set it.
	(process_send_signal): Use it.

	* sysdep.c [DGUX]: Include file.h.

	* xdisp.c (try_window_id): Always update window_end_* if successful.

Sun Jul 21 17:01:38 1991  Jim Blandy  (jimb at geech.gnu.ai.mit.edu)

	* editfns.c (init_editfns): If neither of the environment
	variables are set, DON'T set Vuser_name to Vuser_real_name; it's
	supposed to reflect the EFFECTIVE uid.
	Get the full name according to Vuser_name if it differs from
	Vuser_real_name, not if they are equal.
	And pass Vuser_name to getpwnam in that case instead of user_name,
	which might be 0.

Fri Jul 19 15:15:59 1991  Richard Stallman  (rms at mole.gnu.ai.mit.edu)

	* keyboard.c (read_avail_input) [SYSV_STREAMS]: Don't alter O_NDELAY.
	* x11term.c (x_init_1) [SYSV_STREAMS]: Don't close the old descriptor.

Thu Jul 18 20:14:11 1991  Richard Stallman  (rms at mole.gnu.ai.mit.edu)

	* process.c (process_send_signal): Handle case where there is no pgrp.

Mon Jul 15 04:48:44 1991  Jim Blandy  (jimb at pogo.gnu.ai.mit.edu)

	* process.c (status_notify): GCPRO tail.

Sat Jul 13 16:53:15 1991  Jim Blandy  (jimb at geech.gnu.ai.mit.edu)

	* eval.c (Fapply): If we use funcall_args, GCPRO it.
	And when we call Ffuncall with funcall_args, tell it the correct
	length of funcall_args, no matter which branch allocated it.
	(Feval): If we're calling a subr that takes MANY args, don't
	UNGCPRO until after we call the subr.
	* callint.c (Fcall_interactively): Don't UNGCPRO until after
	Ffuncall returns.

Tue Jul  9 13:27:25 1991  Richard Stallman  (rms at mole.gnu.ai.mit.edu)

	* sysdep.c (discard_tty_input): Do nothing if read_socket_hook.

Mon Jul  8 22:04:15 1991  Richard Stallman  (rms at mole.gnu.ai.mit.edu)

	* process.c (create_process): Use O_NOCTTY whenever defined,
	unless USG.

Sun Jul  7 15:47:50 1991  Richard Stallman  (rms at mole.gnu.ai.mit.edu)

	* process.c (Fprocess_send_eof): If using a pipe, close it.
	(close_process_descs): Check IN and OUT for nonzeroness. 

Thu Jul  4 00:18:48 1991  Richard Stallman  (rms at mole.gnu.ai.mit.edu)

	* process.c (process_send_signal): Use interrupt chars
	to send certain signals to the process group.
	(TIOCGETC): Undefine this if it is not really usable.

Tue Jul  2 15:05:25 1991  Richard Stallman  (rms at mole.gnu.ai.mit.edu)

	* bytecode.c (Fbyte_code): Don't take away GC protection
	of args given to Ffuncall.  Ffuncall expects the caller to protect.

Mon Jul  1 22:28:59 1991  Richard Stallman  (rms at mole.gnu.ai.mit.edu)

	* indent.c (invalidate_current_column): New function.
	* editfns.c (Fwiden, Fnarrow_to_region): Call it.

Sun Jun 30 16:56:33 1991  Richard Stallman  (rms at mole.gnu.ai.mit.edu)

	* keyboard.c (init_keyboard): Test HAVE_TERMIO instead of USG.

	* ymakefile (LIBES): Put gnulib before libc.

	* process.c (list_processes_1): Handle status of network streams.

Sat Jun 29 11:59:22 1991  Richard Stallman  (rms at mole.gnu.ai.mit.edu)

	* search.c: Doc fixes.

	* x11fns.c (Fx_set_foreground_color): Fix prompt.

Sat May 25 02:05:57 1991  Roland McGrath  (roland@geech.gnu.ai.mit.edu)

	* dispnew.c [__GNU_LIBRARY__] (PENDING_OUTPUT_COUNT): Changed FILE
	member names for recent GNU stdio.h reorganization.

Sat May 18 13:10:24 1991  Richard Stallman  (rms at mole.gnu.ai.mit.edu)

	* process.c (Fprocess_status): Finish handling network connections
	right.

Thu May 16 12:16:41 1991  Jim Blandy  (jimb at geech.gnu.ai.mit.edu)

	* eval.c (Ffuncall): Don't gcpro args if we decide to
	garbage-collect; in functions that take MANY arguments, the caller
	gcpros the arguments.

Tue May 14 21:38:59 1991  Richard Stallman  (rms at mole.gnu.ai.mit.edu)

	* keyboard.c (read_command_char): Exit at eof if noninteractive.

Mon May 13 14:40:03 1991  Richard Stallman  (rms at mole.gnu.ai.mit.edu)

	* eval.c (call1, call2, call3): Reorder actions in NO_ARG_ARRAY case.

	* print.c (strout): Set message_buf_print if appropriate.

Wed May  8 16:59:41 1991  Richard Stallman  (rms at mole.gnu.ai.mit.edu)

	* insdel.c (insert_from_string, insert_from_string_before_markers):
	New functions.
	* editfns.c (Finsert, Finsert_before_markers): Use them.

	* eval.c (apply1, call1, call2, call3): Protect arg vector.

	* eval.c (Fapply): Protect funcall_args.

Tue May  7 18:06:52 1991  Richard Stallman  (rms at mole.gnu.ai.mit.edu)

	* s-hpux8.h: New file.

	* fileio.c [HPUX8]: Don't include errnet.h.

	* unexhp9k800.c (unexec): Local variable i to avoid compiler bug?

	* sysdep.c (insque) [WRONG_NAME_INSQUE]: New function.
	* s-386ix.h (WRONG_NAME_INSQUE): Define it.

Sat May  4 12:35:42 1991  Richard Stallman  (rms at mole.gnu.ai.mit.edu)

	* minibuf.c (Ftry_completion): If ignoring case, and all else equal,
	try to preserve the case of the characters in the input.

	* keymap.c (describe_map_tree): `maps' no longer register var.

	* lread.c (init_read): If Vload_path was set specially before dumping,
	preserve it by default.

Fri May  3 15:19:07 1991  Richard Stallman  (rms at mole.gnu.ai.mit.edu)

	* x11term.c (internal_socket_read): Accept XK_Prior and XK_Next
	explicitly as function keys.  Process arrow keys on AIX
	as on other systems.

	* x11term.c (internal_socket_read):
	Don't set x_focus_flag for a FocusIn that is not NotifyNormal.

Fri May  3 00:29:20 1991  Jim Blandy  (jimb at pogo.gnu.ai.mit.edu)

	* x11term.c (delayed_size_change): Added extern declaration for
	this variable, so the Expose and GraphicsExpose event handlers can
	do nothing if there is a pending size change.
	(configure_pending): Variable deleted, since the job
	it used to do is now handled by delayed_size_change.
	(internal_socket_read): rows and cols are now local to the
	ConfigureNotify case, which now calls change_screen_size directly,
	and asks for the size change to be put off until it can be handled
	comfortably; the Expose case now doesn't deal with resizes at all,
	and does not bother to redraw any text if there is a pending
	screen size change.  This eliminates an annoying flicker when the
	window is resized.  GraphicsExpose case follows a similar
	inhibition.
	(x_term_init): Don't initialize configure_pending, since it no
	longer exists.
	(XT_Set_Size_Hints): When calling change_screen_size, ask that the
	size change not be delayed.
	* dispnew.c (in_display): Variable deleted.  It was only tested by
	change_screen_size to see if the change should be delayed, only
	set by the SIGWINCH handler and the X ConfigureNotify code, and
	then only to tell change_screen_size what to do.  It looks like a
	parameter to me.
	(window_change_signal): Instead of incrementing in_display,
	calling change_screen_size, and then decrimenting, just ask
	change_screen_size to delay the change.
	(change_screen_size): Add an argument DELAYED, which indicates
	that now is not a good time to do the size change, and that it
	should be put off until a more convenient juncture.
	(Fset_screen_height, Fset_screen_width): When calling
	change_screen_size, ask that the size change not be delayed.
	* keyboard.c (Fsuspend_emacs): Ditto.
	* window.c (Fset_window_configuration): Ditto.
	* xterm.c (xfixscreen, XSetWindowSize): Ditto.

Wed May  1 12:30:51 1991  Richard Stallman  (rms at mole.gnu.ai.mit.edu)

	* keymap.c (describe_map_tree): GCPRO maps.

Tue Apr 30 23:54:29 1991  Richard Stallman  (rms at mole.gnu.ai.mit.edu)

	* process.c (wait_reading_process_input):
	Check NETCONN_P when checking for EIO.

Tue Apr 30 14:28:45 1991  Jim Blandy  (jimb at churchy.gnu.ai.mit.edu)

	* window.c (save_window_save): Always get the selected window's
	value of point from its buffer, not just when it's also the
	current buffer.

Mon Apr 29 23:36:30 1991  Jim Blandy  (jimb at churchy.gnu.ai.mit.edu)

	* abbrev.c (Fdefine_abbrev): When type-checking arguments, allow
	EXPANSION to be nil.

Sat Apr 27 21:56:59 1991  Jim Blandy  (jimb at pogo.gnu.ai.mit.edu)

	* keyboard.c (syms_of_keyboard): Qtop_level is initialized and
	staticpro'd in syms_of_data too.  Don't staticpro (or initialize)
	it again here.

	* macros.c (syms_of_macros): Since executing-macro and
	executing-kbd-macro are actually the same variable, use
	DEFVAR_LISP_NOPRO for the second one so it doesn't get staticpro'd
	twice.

	* process.c (syms_of_process): Don't staticpro or initialize Qexit
	here, since syms_of_eval already does this and it's bad to
	staticpro something twice.
	(Qexit): Remove declaration here, so there will be a compilation
	error if someone rearranges eval.c without fixing the Qexit stuff.
	* eval.c (syms_of_eval): Add comment here to say that
	syms_of_process cares about Qexit too.

	* lread.c (init_obarray): Don't staticpro Vobarray, since the
	DEFVAR_LISP in syms_of_read takes care of that.

Sun Apr 21 14:44:33 1991  Roland McGrath  (roland at albert.gnu.ai.mit.edu)

	* filelock.c (lock_file_owner_name): Declare type of arg properly.

Mon Apr 15 16:35:35 1991  Eric Youngdale (youngdale@v6550c.nrl.navy.mil)

	* alloc.c (pure): No need to initialize under VMS.  If we do
	initialize the executable is 132000 bytes larger

	* callproc.c, emacs.c: Fix def of environ when compiling with GCC
	under VMS.

	* fileio.c: fix data type of vms_file_written.

	* malloc.c: Add a couple of type casts.

	* s-vms.h: Define cfree.  This keeps VAXCRTL memory management
	functions from getting their grubby fingers in our memory.

	* s-vms.h, vmsmap.c: Give proper name to sdata such that $D$ATA
	and __DATA correctly bracket the impure memory.  Increase size of
	sdata and DATA_START, to make sure that impure memory starts at an
	address > 8191, since otherwise garbage collection gets very
	confused and Emacs bombs with peculiar errors.  

	Remove some flotsam in mapin_data - someone was trying to save the
	argv and argc parameters, but never bothered to pass them in the
	first place.  This was wrong to begin with, since the reason the
	argv and argc parameters were saved in the dump file was that
	calloc was not defined as sys_calloc in s-vms.h

	* sysdep.c: Include strings.h, and fix data type of dummy.  Add
	check to make sure that va_count is not already defined.

	* vmsfns.c: Add type cast.

Sun Apr 14 22:56:47 1991  Richard Stallman  (rms at mole.gnu.ai.mit.edu)

	* compile.com: Comments added for how to use GCC.
	* link.com: Alternative command for linking if GCC is in use.

	* malloc.c: Add forward decl for `malloc'.

Sat Apr 13 18:10:28 1991  Eric Youngdale  (youngdale@v6550c.nrl.navy.mil)

	* sysdep.c (creat_copy_attrs, rename_sans_version):  Always set
	protection to O:REWD when creating file.  Added new function
	rename_sans_version, which strips the version number from the target
	filename, renames the temporary file to this filename,  and then
	sets the file protection of this new file to be the same as the file
	being edited.

	* fileio.c (write-region): Use rename_sans_version instead of rename.

Sun Apr 14 00:26:45 1991  Richard Stallman  (rms at mole.gnu.ai.mit.edu)

	* xdisp.c (display_text_line, display_string):
	Don't go past endp for multi-column chars.

Fri Apr 12 20:26:28 1991  Richard Stallman  (rms at mole.gnu.ai.mit.edu)

	* editfns.c (init_editfns): Turn off polling.

Tue Apr  9 19:25:22 1991  Richard Stallman  (rms at apple-gunkies)

	* sysdep.c (child_setup_tty): Turn off erase & kill chars for BSD.

	* editfns.c (init_editfns): Don't call getpwnam (0).

Thu Apr  4 14:56:33 1991  Richard Stallman  (rms at mole.gnu.ai.mit.edu)

	* editfns.c (clip_to_bounds): Not static.

	* vmsfns.c (vms_trnlog): Increased size of str to 256 elements.
	(vms_symbol): Increased size of str to 1025 elements.

Wed Apr  3 21:13:09 1991  Richard Stallman  (rms at mole.gnu.ai.mit.edu)

	* window.c (unshow_buffer): Keep PT in bounds when setting it.

Tue Apr  2 17:57:37 1991  Richard Stallman  (rms at mole.gnu.ai.mit.edu)

	* process.c (Fprocess_status): Test of childp was backwards.

Mon Apr  1 00:06:36 1991  Richard Stallman  (rms at mole.gnu.ai.mit.edu)

	* emacs.c: Include headers to get FIONREAD, as in keyboard.c.

Sun Mar 31 15:38:48 1991  Richard Stallman  (rms at mole.gnu.ai.mit.edu)

	* dired.c (file_name_completion_stat): Use lstat.
	* fileio.c (Ffile_exists_p): Use lstat.

	* getpagesize.h [VMS]: Include param.h from Emacs.
	* malloc.c (vms_current_brk): Delete spurious ampersand.
	* s-vms.h (getppid): New macro.
	(sdata): Alternate declaration for GNU C.
	(Vminibuffer_completion_table, etc.): New macros.
	* sysdep.c [VMS]: Include pwd.h from Emacs.  Use sys/file.h if GCC.
	(F_SETFL) [VMS]: Undefine this, to control conditionals.
	(bzero, bcopy) [VMS]: Don't take address of `length'.
	(getpwnam): Make `full' unsigned.
	(creat_copy_attrs): Add some casts.
	(sys_access): Change prvmask and CHECKPRIV to use bitfields.
	Add some casts.
	(vmserrstr): Add a cast.
	* vmsmap.c (mapin_data, mapout_data): Add some casts.
	(sdata, edata): Alternate declarations for GNU C.
	* vmsfns.c: Include clidef.h and syidef.h.
	(getjpi, translate_id): Add cast.
	(translate_id): Make p unsigned.
	(Fvms_system_into, Fsetprv): Likewise for other variables.
	(Fspawn_subprocess): Cast call to xmalloc.
	(vms_version_fn, vms_trnlog, vms_symbol): Add casts.

	* minibuf.c (Ftry_completion): Fix error in previous change.

	* editfns.c, filelock.c [VMS]: Use pwd.h from Emacs, not from system.
	* fileio.c [VMS]: Likewise.  Also include stddef.h, string.h.
	Include perror.h only once.
	(expand_file_name): Cast result of index.

	* window.c (replace_window, unshow_buffer, save_window_save):
	Add forward declarations.  Make some return void.
	* keymap.c (insert_first_line): Likewise.
	* lread.c (read_escape): Likewise.
	* unexec.c (make_hdr, copy_text_and_data, copy_sym, mark_x): Likewise.
	* x11term.c (XInitWindow): Likewise.

	* x11term.c: Cast args to avoid warnings from XLib fns.

Sat Mar 30 17:53:09 1991  Richard Stallman  (rms at mole.gnu.ai.mit.edu)

	* sysdep.c (sys_sleep, input_wait_timeout): Don't use & on constant.
	(sys_access): Likewise.
	(sys_creat): Define va_count.
	* vmsfns.c (Fspawn_subprocess, create_mbx): Don't use & on constant.
	(translate_id, vms_version_fn, vms_proclist
	(JPI$_MASTER_PID, JPI$_CLINAME): Don't define if already defined.
	(CLI$M_NOWAIT, SYI$_VERSION): Likewise.

	* lastfile.c, filelock.c, process.c: Add a dummy function if VMS.

	* fileio.c: Change VMS conditionals for header files.

	* dir.h (dir$t_name, dir$t_linkname): Use standard syntax for pointer.

	* callproc.c (environ) [VMS and __GNUC__]: Different declaration.

Mon Mar 25 17:53:38 1991  Richard Stallman  (rms at mole.gnu.ai.mit.edu)

	* minibuf.c (Ftry_completion): Fix handling of matches aside from case.

	* dispnew.c (update_line): Crash if obody[-1] is clobbered.

Sun Mar 24 21:15:45 1991  Richard Stallman  (rms at mole.gnu.ai.mit.edu)

	* x11term.c (x_io_error_handler): Raise a signal to kill Emacs.

	* m-news-risc.h (LD_SWITCH_MACHINE): New definition if USG.
	(LOAD_AVE_TYPE): Likewise.
	(START_FILES, LIB_STANDARD): Undef before m-mips.h.
	(alloca): Use built-in with GCC.

Sat Mar 23 16:14:43 1991  Richard Stallman  (rms at mole.gnu.ai.mit.edu)

	* fileio.c (directory_file_name): Fix off-by-one testing slen at end.
	(Fexpand_file_name): Remove excess slash from end of user's home dir.

Fri Mar 22 18:19:21 1991  Richard Stallman  (rms at mole.gnu.ai.mit.edu)

	* s-usg5-4.h (DATA_SEG_BITS): Definition deleted.
	* m-intel386.h (DATA_SEG_BITS): Define here if USG5_4.

Thu Mar 21 17:16:15 1991  Richard Stallman  (rms at mole.gnu.ai.mit.edu)

	* m-mips.h: INHIBIT_BSD_TIME prevents including bsd/sys/time.h.

	* m-news-risc.h: Add conditionals for USG.

	* unexmips.c [sony]: Include getpagesize.h and fcntl.h.

Tue Mar 19 17:30:09 1991  Richard Stallman  (rms at mole.gnu.ai.mit.edu)

	* keyboard.c (read_avail_input): Raise SIGHUP if no input on AIX.

Mon Mar 18 18:38:55 1991  Roland McGrath  (roland at geech.ai.mit.edu)

	* minibuf.c (assoc_for_completion): Add missing defn of local var.

Mon Mar 18 17:09:40 1991  Richard Stallman  (rms at mole.ai.mit.edu)

	* xkeys-aix.h: Turn on redefinition of backspace.

	* x11term.c (x_term_init): Handle X_DEFAULT_FONT.

Sun Mar 17 23:50:50 1991  Richard Stallman  (rms@mole.ai.mit.edu)

	* minibuf.c (assoc_for_completion): New function.
	(do_completion): Use that to check for exact match.

Thu Mar 14 17:06:14 1991  Richard Stallman  (rms at mole.ai.mit.edu)

	* fileio.c (Fwrite_region): On VMS, don't try rewriting old version.

Mon Mar 11 21:09:02 1991  Richard Stallman  (rms at mole.ai.mit.edu)

	* xdisp.c (redisplay, try_window_id): Special case for change
	at beginning of line, if using selective display.

Sun Mar 10 19:44:50 1991  Richard Stallman  (rms at mole.ai.mit.edu)

	* fileio.c (Fmake_symbolic_link): Don't expand FILENAME.

Sat Mar  9 22:59:19 1991  Richard Stallman  (rms at mole.ai.mit.edu)

	* eval.c (Fcatch, internal_condition_case): Fill in c.handlerlist.

	* buffer.c (Frename_buffer): Refuse to rename a minibuffer.

Fri Mar  8 02:52:31 1991  Richard Stallman  (rms at mole.ai.mit.edu)

	* m-intel386.h (signal): Maybe define if USG.

	* keyboard.c (echo_char): Don't have a space at end of echobuf.

Wed Mar  6 14:32:14 1991  Richard Stallman  (rms at mole.ai.mit.edu)

	* s-vms.h (DATA_START): Remove `+ 512'.

Tue Mar  5 14:04:03 1991  Richard Stallman  (rms at mole.ai.mit.edu)

	* emacs.c, xterm.c:
	Handle BROKEN_FIONREAD, to undef FIONREAD and SIGIO.

	* m-amdahl.h (LIBX11_SYSTEM): Undefine it.

Sun Mar  3 17:15:44 1991  Richard Stallman  (rms at mole.ai.mit.edu)

	* sysdep.c (MEMORY_IN_STRING_H): New compilation flag.
	* s-isc2-2.h: New file.

	* emacs.c: Use EQ rather than NULL.
	Include stdio.h after lisp.h, and preserve its meaning of NULL.

	* gettime.h: New file.  Handles time.h and/or sys/time.h.
	* process.c, x11term.c, x11fns.c: Use that, not those others directly.
	Make sure to include sys/socket.h first, if have sockets.

Tue Feb 26 23:44:05 1991  Richard Stallman  (rms at mole.ai.mit.edu)

	* s-vms.h (calloc): Define it like malloc, etc.

Tue Feb 26 15:07:30 1991  Jim Blandy  (jimb at churchy.ai.mit.edu)

	* editfns.c (in_accessible_range): Deleted - insufficently general.
	(clip_to_bounds): New function, much like in_accessible_range,
	except that the upper and lower bounds are arguments.
	(goto_char, save_restriction_restore): Rewritten to use
	clip_to_bounds instead of in_accessible_range.

Mon Feb 25 23:44:31 1991  Richard Stallman  (rms at mole.ai.mit.edu)

	* x11term.c (xfixscreen): Move static var outside function.

Sun Feb 24 15:57:05 1991  Richard Stallman  (rms at mole.ai.mit.edu)

	* m-amdahl.h (C_OPTIMIZE_SWITCH): Don't define if already defined.
	(HAVE_TIMEVAL, MISSING_UTIMES, HAVE_SELECT, HAVE_PTYS, HAVE_SOCKETS):
	(BSTRING, BROKEN_FIONREAD, LIBX11_MACHINE): New macros.
	* process.c, x11term.c (sys/time.h): Treat uts like aix.

	* xdisp.c (message_buf_print): New variable.
	* dispextern.h: Declare it.
	* xdisp.c (message): Store 0 there.
	* print.c (printchar): Use and set it.

	* process.c (wait_reading_process_input): Use NETCONN_P.

Sat Feb 23 15:22:57 1991  Richard Stallman  (rms at mole.ai.mit.edu)

	* process.c (send_process): Handle EAGAIN like EWOULDBLOCK.

Fri Feb 22 15:47:47 1991  Richard Stallman  (rms at mole.ai.mit.edu)

	* xkeys-aix.h: Move unmodified keys to the end.

Thu Feb 21 14:55:21 1991  Richard Stallman  (rms at mole.ai.mit.edu)

	* window.h (prev_echo_area_contents): Declare it.
	* minibuf.c (do_completion): Clear that var before temporary message.

	* fileio.c (report_file_error): Don't downcase "I/O".

Sat Feb  9 13:23:05 1991  Richard Stallman  (rms at mole.ai.mit.edu)

	* sysdep.c (TERMINAL): Move the definitions inside other #ifdef's.
	(tcgetattr): New sym.  Define as macro if not HAVE_TCATTR.
	Use instead of ioctl TIOCGETP.
	(discard_tty_input, child_setup_tty, init_sys_modes, reset_sys_modes):
	If HAVE_TCATTR, use tcsetattr.
	(init_sys_modes): Handle VSUSP, V_DSUSP if HAVE_TCATTR.

	* vmsmap.c (mapin_data): Save and restore argv; copy the strings.

	* m-amdahl.h (NO_SIOCTL_H): Defined.

	* x11fns.c, x11term.c: Include fcntl.h only once.

	* window.c (syms_of_window): New variable minibuffer-prompt-width.

	* emacs.c (decode_env_path): Ignore EVARNAME if 0.
	* lread.c (init_read): Change call.
	* callproc.c (init_callproc): Likewise.

	* sysdep.c (dup2): Rewrite of non-F_DUPFD case.

Fri Feb  8 00:03:24 1991  Richard Stallman  (rms at mole.ai.mit.edu)

	* m-intel386.h (LOAD_AVE_CVT): Add extra parens.
	* s-usg5-4.h (LIBX11_SYSTEM): #undef it.

Thu Feb  7 12:47:24 1991  Richard Stallman  (rms at mole.ai.mit.edu)

	* search.c (Fmatch_data): Return ints for values above buf size.

	* callint.c (global_map): Make declaration extern.
	* process.c (Qexit): Likewise.

Wed Feb  6 02:55:40 1991  Richard Stallman  (rms at mole.ai.mit.edu)

	* dispnew.c (update_line): If nlen becomes 0, go to just_erase.

	* process.c (create_process): On Apollo, use O_NOCTTY to open pty.

	* process.c (wait_reading_process_input): Special case APOLLO like sun.

	* sysdep.c (discard_tty_input): Use TIOCFLUSH on Apollo.
	(init_sys_modes): Avoid TIOCSTART on Apollo.

	* keyboard.c (command_loop_1):
	Don't clear last_command when start macro.

	* window.c (init_window_once): Set use_time to 1 for root_window.

Tue Feb  5 00:27:33 1991  Richard Stallman  (rms at mole.ai.mit.edu)

	* xdisp.c (display_text_line, display_string):
	Don't write past end of available space.
	* dispnew.c (update_line): Don't clobber the null that follows
	the writable space in a screen line.

	* x11fns.c: Always include ioctl.h except on VMS.

	* keyboard.c (this_command_keys): Now type unsigned char *.
	(read_command_char, Fexecute_command_char): Cast to proper type.
	(init_keyboard): Likewise.

Mon Feb  4 17:50:45 1991  Richard Stallman  (rms at mole.ai.mit.edu)

	* s-sunos4-0.h: Renamed from s-sunos4.h.
	(read, write, open, close): Macro defs moved to s-sunos4-1.h.
	(INTERRUPTABLE_*): Likewise.
	* s-sunos4-1.h: New file.

Sun Feb  3 21:50:00 1991  Richard Stallman  (rms at mole.ai.mit.edu)

	* Makefile, ymakefile (SHELL): Force use of sh.

	* s-usg5-4.h (USG5_4): Define it.
	(LOAD_AVE_*): Don't define them.
	* m-intel386.h (LOAD_AVE_*): Define, if USG5_4.

	* buffer.c (Fbuffer_local_variables): Omit slots with no names.

Sat Feb  2 11:45:44 1991  Richard Stallman  (rms at mole.ai.mit.edu)

	* process.c (Fprocess_status): For net stream, return Qopen or Qclosed.

	* eval.c (struct catchtag): New slot `handlerlist'.
	(internal_catch): Record that.
	(unbind_catch): Use that.

Thu Jan 31 16:13:41 1991  Richard Stallman  (rms at mole.ai.mit.edu)

	* x11term.c (XTfeep): Pass 0 as second arg to XBell.

Tue Jan 29 14:55:06 1991  Richard Stallman  (rms at mole.ai.mit.edu)

	* unexec.c (make_hdr) [TPIX]: Set f_hdr.f_nscns and f_thdr.f_scnptr.

	* sysdep.c [BROKEN_TIOCGWINSZ]: Undef TIOCGWINSZ.

	* malloc.c (cfree): New function.

	* process.c (wait_reading_process_input): Don't ignore
	a zero-length read on a network connection.  Do close it.

	* sysdep.c (hft_init, hft_reset): Pass &junk as arg to HFQERROR.

Fri Jan 25 16:40:33 1991  Richard Stallman  (rms at mole.ai.mit.edu)

	* Version 18.57 released.

	* eval.c (Fthrow, Fsignal): Restore poll-suppress count, don't crash.

	* regex.c (re_match_2): Value of PTR_CHAR_POS is off by 1; compensate.

Thu Jan 24 12:43:35 1991  Richard Stallman  (rms at mole.ai.mit.edu)

	* x11term.c (XT_GetDefaults): Support XBACKWARDS.

Wed Jan 16 18:57:00 1991  Richard Stallman  (rms at mole.ai.mit.edu)

	* Version 18.56 released.

Tue Jan 15 13:13:36 1991  Richard Stallman  (rms at mole.ai.mit.edu)

	* sysdep.c (init_sys_modes):
	Don't mess with VSUSP, V_DSUSP except on a Mips.

	* process.c (create_process): Use SETUP_SLAVE_PTY if defined.

	* s-usg5-4.h (HAVE_PTYS, HAVE_SETSID): Defined.
	(HAVE_WAIT_HEADER, WAITTYPE, wait3, WRETCODE): New macros.
	(TIOCSIGSEND): Alias for TIOCSIGNAL.
	(FIRST_PTY_LETTER): Overridden.
	(PTY_NAME_SPRINTF, PTY_TTY_NAME_SPRINTF, SETUP_SLAVE_PTY): New macros.

	* m-ibmrs6000.h (LINKER): Add -bnodelcsect.

	* x11fns.c (Fx_get_default): XBACKWARDS flips XGetDefault args.

Mon Jan 14 13:30:32 1991  Richard Stallman  (rms at mole.ai.mit.edu)

	* sysdep.c (hft_init, hft_reset): Do nothing if not HFT.

	* m-ibmrs6000.h (CANNOT_DUMP): Undefine it.
	(UNEXEC): Define it.
	(PURE_SEG_BITS, SHMKEY): Define only if CANNOT_DUMP.
	(LINKER): Override it.

Sun Jan 13 23:10:34 1991  Richard Stallman  (rms at mole.ai.mit.edu)

	* s-usg5-4.h (LOAD_AVE_CVT): Cast value to int.

Sat Jan 12 14:50:45 1991  Richard Stallman  (rms at mole.ai.mit.edu)

	* s-irix3-3.h (HAVE_SYSVIPC): Defined.

Fri Jan 11 11:45:19 1991  Richard Stallman  (rms at mole.ai.mit.edu)

	* emacs.c (Fkill_emacs): Turn off SIGIO before exiting.

	* s-usg5-3.h (USG5_3): Define it.
	* m-ibmps2-aix.h [USG5_3]: Define TEXT_START as 0.
	Don't define DATA_START or DATA_END or TEXT_END or DATA_SEG_BITS.
	Override various other symbols at end of file.

	* m-tower32v3.h (VALBITS, GCTYPEBITS): Use 26 bits for pointer.

Thu Jan 10 12:33:20 1991  Richard Stallman  (rms at mole.ai.mit.edu)

	* x11fns.c (Fx_debug, Fx_get_cut_buffer, Fx_get_*_color):
	Call check_xterm.

	* fileio.c (Fcopy_file): Always close descriptors.

	* s-sunos4.h: read, write, open and close are interruptable.

Tue Jan  8 20:46:34 1991  Richard Stallman  (rms at mole.ai.mit.edu)

	* keyboard.c (input_available_signal): If FIONREAD fails, do SIGHUP.

Sun Jan  6 23:25:24 1991  Richard Stallman  (rms at mole.ai.mit.edu)

	* sysdep.c (init_sys_modes): Turn off VSUSP and V_DSUSP if they exist.

Thu Jan  3 17:30:46 1991  Richard Stallman  (rms at mole.ai.mit.edu)

	* search.c (search_buffer): Return starting position if count == 0.

Thu Dec 27 13:54:20 1990  Richard Stallman  (rms at mole.ai.mit.edu)

	* m-tower32.h: Add comments for how to optimize.
	* m-tower32v3.h: New file.

	* fileio.c (Fwrite_region): Save errno around unlock_file.

Thu Dec 20 18:09:19 1990  Richard Stallman  (rms at mole.ai.mit.edu)

	* term.c (ins_del_lines): Handle scroll region wrt chars_wasted.

Wed Dec 19 19:04:27 1990  Richard Stallman  (rms at mole.ai.mit.edu)

	* alloc.c (memory_full): Use preallocated arg to Fsignal.
	(syms_of_alloc): Preallocate it.

	* bytecode.c (Fbyte_code): Consider GC in each loop.

Wed Dec 12 16:17:56 1990  Richard Stallman  (rms at mole.ai.mit.edu)

	* keyboard.c (command_loop_1): Really bind inhibit-quit.

	* abbrev.c (Fdefine_abbrevs): Don't crash when EXPANSION is nil.

Wed Dec 12 03:35:47 1990  Chris Hanson  (cph at kleph)

	* keyboard.c (command_loop_1): Bind inhibit-quit to t while
	displaying message over active minibuffer.

	(get_input_pending): If quit-flag is set by read_avail_input,
	count that as an input character.

Mon Dec 10 00:11:29 1990  Richard Stallman  (rms at mole.ai.mit.edu)

	* m-pmax.h (SYSTEM_MALLOC): Define it.

	* search.c: Doc fix.

	* process.c (wait_reading_process_input): Ignore failure with EIO.

	* process.c (create_process): Delete duplicate sigsetmask.

Sun Dec  9 23:38:51 1990  Richard Stallman  (rms at mole.ai.mit.edu)

	* m-ibmrt.h (RTPC_REGISTER_BUG, SHORT_CAST_BUG): Macros deleted.
	(C_SWITCH_MACHINE): Use -D to define alloca.
	(SIGN_EXTEND_CHAR): Use a cast.

Sun Dec  2 15:39:18 1990  Richard Stallman  (rms at mole.ai.mit.edu)

	* fns.c (Fload_average): Add IRIS conditional.

	* m-iris4d.h (LOAD_AVE_CONVERT): Divide by 1024.

	* s-irix3-3.h (ADDR_CORRECT): Macro deleted.
	(LIBS_MACHINE): Macro deleted.
	(LDAV_SYMBOL): Delete the `_' from start of symbol.

	* process.c (status_notify): Was failing to UNGCPRO for dead buffer.

Fri Nov 30 18:07:13 1990  Richard Stallman  (rms at mole.ai.mit.edu)

	* process.c (read_process_output, exec_sentinel): Don't catch errors.

	* keyboard.c (read_command_char): Save and restore getcjmp.

Thu Nov 29 16:57:02 1990  Richard Stallman  (rms at mole.ai.mit.edu)

	* x11term.c (XT_Set_Size_Hints): Rewrite XICCC case.

	* process.c (status_convert): Use WRETCODE for exited process.

Wed Nov 28 18:02:40 1990  Richard Stallman  (rms at mole.ai.mit.edu)

	* x11term.c (x_term_init):
	Use progname as XXidentity even if matches CLASS.
	* x11term.h (CLASS): Use Emacs, not emacs.

	* s-386ix.h (ISC): New macro.

Tue Nov 27 14:19:44 1990  Richard Stallman  (rms at mole.ai.mit.edu)

	* dispnew.c (PENDING_OUTPUT_COUNT): Alternate defn for GNU library.

Mon Nov 26 14:34:12 1990  Richard Stallman  (rms at mole.ai.mit.edu)

	* x11term.c (XTfeep): Do nothing unless HAVE_SELECT and HAVE_TIMEVAL.

	* s-sunos4.h (O_NDELAY): Don't define this.

	* s-usg5-4.h (LIB_STANDARD): Add libucb.a.

	* print.c (Fwith_output_to_temp_buffer): Don't eval first arg twice.

Thu Nov 22 14:24:00 1990  Richard Stallman  (rms at mole.ai.mit.edu)

	* m-hp9000s300.h (LOAD_AVE_TYPE, LOAD_AVE_CVT): Override for BSD.

	* doc.c (Fsubstitute_command_keys): Use IDX only around GC points.
	Get rid of SEND.

Wed Nov 21 14:43:01 1990  Richard Stallman  (rms at mole.ai.mit.edu)

	* m-mips4.h (MIPS2): Undefine this.

	* x11term.c (internal_socket_read):
	Avoid redrawing cursor when no change.

Tue Nov 20 17:12:41 1990  Richard Stallman  (rms at mole.ai.mit.edu)

	* process.c (sigchld_handler): Don't look for new proc if found old.

	* x11term.c (internal_socket_read): Record whether have explicit focus.
	Handle LeaveNotify events accordingly.

	* fns.c (Fyes_or_no_p): Protect PROMPT for entire loop.
	* process.c (status_notify): Protect MSG.

	* doc.c (Fsubstitute_command_keys): Protect STR and don't keep a
	pointer to the middle of it.
	* keyboard.c (Fsuspend_emacs): Protect STUFFSTRING.
	(cmd_error): Protect TAIL while printing.
	* keymap.c (describe_alist): Protect ELT_PREFIX and TEM2.
	(describe_vector): Likewise for ELT_PREFIX and TEM1.
	(insert_first_line): Protect STR.

	* process.c (Fstart_process): Set BUFFER before other string vars
	so a gc in Fget_buffer_create won't clobber them.

	* process.c (Fopen_network_stream): Protect various args.
	* print.c (Fprin1_to_string, Fprint): Protect OBJ.
	* fileio.c (Frename_file): Protect args.
	* search.c (Freplace_match): Protect STRING.

	* dispnew.c (syms_of_dispnew): Don't clobber Vwindow_system_version
	if CANNOT_DUMP.

Mon Nov 19 17:56:18 1990  Richard Stallman  (rms at mole.ai.mit.edu)

	* emacs.c (Fkill_emacs): Protect ARG.

	* fileio.c (Fadd_name_to_file): Protect the args.
	(Fcopy_file, Fmake_symbolic_link): Likewise.
	(Finsert_file_contents): Protect FILENAME.

	* buffer.c (Fbury_buffer): Don't init BUF1.

	* eval.c (Fbacktrace): Protect TAIL from GC.

	* scroll.c (CalcIDCosts1): Use calculate_costs_hook.
	* x11term.c (x_term_init): Set up the hook.
	(XTcalculate_costs): New function.
	* dispnew.c (init_display): Call calculate_costs here.
	* term.c (term_init): Not here.

Thu Nov 15 16:29:18 1990  Richard Stallman  (rms at mole.ai.mit.edu)

	* lread.c (Feval_region): Check type of B.

	* dired.c (file_name_completion): Use CHECK_STRING on FILE.

Tue Nov 13 12:04:10 1990  Richard Stallman  (rms at mole.ai.mit.edu)

	* process.c (sigchld_handler): If pid not recognized, look for a
	process recorded with pid -1.
	(create_process): Set pid to -1 before the fork.
	Store correct pid right after the fork.
	Don't change sigchld handler on system V.

	* keyboard.c (input_poll_signal, start_polling): Use polling_period.
	(syms_of_keyboard): Initialize it and make it a Lisp var.

	* malloc.c: Use vlimit on VMS.

	* process.c (create_process): Handle HAVE_SETSID when not USG.

	* x11term.c (XT_GetDefaults): Handle temp_useBitmap.
	(xDefaultsValueTable): Handle bitmapIcon.

	* fileio.c (err_str): New macro.
	(Finsert_file_contents, Fwrite_region): Use it in error messages.

Mon Nov 12 17:18:00 1990  Richard Stallman  (rms at mole.ai.mit.edu)

	* insdel.c (del_range): Supply missing arg to gap_left.

	* indent.c (Findent_to): Don't fail to return a value.

	* process.c (run_filter): New function.
	(read_process_output, exec_sentinel): Use it to call the function.

Sun Nov 11 00:37:50 1990  Richard Stallman  (rms at mole.ai.mit.edu)

	* xdisp.c (try_window_id): When checking val.hpos < 0,
	to update tab_offset, correct for hscroll.

	* ymakefile (xemacs): Link xemacs to temacs if HAVE_SHM.

	* m-ibmrs6000.h (HAVE_SHM): Undefine this since does not work.

	* fns.c (Fnthcdr): Stop loop if reach end.

	* dispnew.c: Undef SIGIO if no FIONREAD.
	Include fcntl.h if HAVE_TERMIO.

Fri Nov  9 23:22:37 1990  Chris Hanson  (cph at kleph)

	* eval.c (struct catchtag): Add new element `poll_suppress_count',
	which records the value of that variable at the time the catchtag
	is bound.
	(internal_catch): Initialize the new element.
	(Fcondition_case): Likewise.
	(internal_condition_case): Likewise.
	(Fthrow): Instead of calling `barf_if_polling_suppressed', abort
	if current value of `poll_suppress_count' is different from what
	it was when the catchtag was bound.

	* keyboard.c (barf_if_polling_suppressed): Delete this, it's not
	referred to anymore.

Tue Nov  6 21:37:36 1990  Richard Stallman  (rms at mole.ai.mit.edu)

	* process.c (wait_reading_process_input): Don't read input
	from more than one process between calls to `select'.

	* m-ibmrs6000.h (CANNOT_DUMP): Define this.

	* process.c (create_process): Unblock SIGCHLD in the child.

Mon Nov  5 18:38:18 1990  Chris Hanson  (cph at kleph)

	* keyboard.c: Define and initialize the variable
	`poll_suppress_count' even when polling is not being used.
	* lisp.h: Extern the variable `poll_suppress_count'.

	* lisp.h (struct handler): Add new element `poll_suppress_count',
	which records the value of that variable at the time the handler
	is bound.  
	* eval.c (Fcondition_case): Initialize new element.
	(internal_condition_case): Likewise.
	(Fsignal): Instead of calling `barf_if_polling_suppressed', abort
	if current value of `poll_suppress_count' is different from what
	it was when the handler was bound.

Fri Nov  2 15:13:17 1990  Richard Stallman  (rms at mole.ai.mit.edu)

	* malloc.c (get_lim_data): Test !BSD4_1, not BSD4_2.

	* callint.c (syms_of_callint):
	Initialize Vprefix_arg and Vcurrent_prefix_arg.

Fri Nov  2 01:34:47 1990  Chris Hanson  (cph at kleph)

	* keyboard.c (barf_if_polling_suppressed): Don't do anything
	unless `read_socket_hook' is nonzero.

	* keyboard.c (barf_if_polling_suppressed): Define this again, but
	don't do anything if `initialized' is not set.
	* eval.c (Fthrow): Call it.
	(Fsignal): Call it.

	* lisp.h: Define `Qinhibit_quit'.
	* eval.c: Likewise.

Fri Nov  2 01:09:20 1990  Richard Stallman  (rms at mole.ai.mit.edu)

	* process.c (read_process_output): Inhibit quit in filter.
	(exec_sentinel): Likewise.

Wed Oct 31 18:13:08 1990  Chris Hanson  (cph at kleph)

	* keyboard.c (barf_if_polling_suppressed): Delete this function.
	(quit_throw_to_read_command_char): Inline call to it here.
	* eval.c (Fthrow, Fsignal): Delete calls to it.

Wed Oct 31 00:45:39 1990  Richard Stallman  (rms at mole.ai.mit.edu)

	* process.c (wait_reading_process_output): Don't turn off polling.

	* keyboard.c (barf_if_polling_suppressed): New function.
	(quit_throw_to_read_command_char): Call it.
	* eval.c (Fthrow): Call it.
	(Fsignal): Call it.

Thu Oct 25 22:39:24 1990  Richard Stallman  (rms at mole.ai.mit.edu)

	* x11fns.c (Fx_store_cut_buffer): Clear selection owner.

Wed Oct 24 15:18:14 1990  Richard Stallman  (rms at mole.ai.mit.edu)

	* ymakefile (GNULIB_VAR): New make variable.
	(LIBES): Use that, not LIB_GCC directly.
	(LIB_GCC): Renamed from GNULIB.  Don't define if already defined.

Tue Oct 23 01:19:25 1990  Roland McGrath  (roland at churchy.ai.mit.edu)

	* x11fns.c, x11term.c: Include header for FIONREAD.

Mon Oct 22 14:07:45 1990  Richard Stallman  (rms at mole.ai.mit.edu)

	* scroll.c (struct matrix_elt): Use ints for costs.
	* dispextern.h (INFINITY): Moved here from scroll.c.
	* dispnew.c (scrolling): If new line not enabled, draw cost = INFINITY.

	* keyboard.c (quit_char): New variable.
	(init_keyboard): Initialize it.
	(Fset_input_mode): New optional arg to set quit_char.
	(command_loop_1, read_command_char, kbd_buffer_store_char):
	(read_avail_input, input_available_signal): Use quit_char, not C-g.
	* sysdep.c (init_sys_modes): Use quit_char to set special chars.
	* x11term.c (x_init_1): Call to Fset_input_mode fixed.

Sun Oct 21 15:21:39 1990  Richard Stallman  (rms at mole.ai.mit.edu)

	* sysdep.c (select): Handle timeout == 0.  Add var local_timeout.

	* ymakefile (LIBES): Put LIBS_SYSTEM and LIBS_MACHINE after LIBX.

	* x11fns.c: After config.h, maybe undef FIONREAD and SIGIO.

	* alloc.c (Fcons, Fmake_vector, Fmake_symbol, Fmake_marker):
	(make_uninit_string): Use VALIDATE_LISP_STORAGE.
	(VALIDATE_LISP_STORAGE): New macro.

	* fileio.c (Fcopy_file): Detect error closing output.

Sat Oct 20 00:59:31 1990  Richard Stallman  (rms at mole.ai.mit.edu)

	* xdisp.c (message, message1): Clear noninteractive_need_newline.

Fri Oct 19 17:25:48 1990  Richard Stallman  (rms at mole.ai.mit.edu)

	* buffer.c: Doc fix.

Thu Oct 18 13:43:50 1990  Richard Stallman  (rms at mole.ai.mit.edu)

	* m-intel386.h (alloca): Define as builtin, if using GCC.

	* ymakefile (GNULIB): New macro.
	(LIBES): Use that macro.  Fixes linking if compiled with GCC.

	* m-att3b.h (NEED_PTEM_H): Define this for 3b2.

	* s-aix3-1.h (SYSV_SYSTEM_DIR): Define it.

	* print.c (print): Improve error message for bad data type.

Wed Oct 17 12:04:18 1990  Richard Stallman  (rms at mole.ai.mit.edu)

	* m-delta.h (C_DEBUG_SWITCH): Don't define this.

Tue Oct 16 13:23:37 1990  Richard Stallman  (rms at mole.ai.mit.edu)

	* x11fns.c (Fx_get_default): Test for XXidentity non-empty.

	* data.c (arith_error): Reestablish handler on VMS.

	* process.c (status_convert): If killed by signal, use WTERMSIG.

Mon Oct 15 00:27:43 1990  Richard Stallman  (rms at mole.ai.mit.edu)

	* alloc.c (truncate_all_undos): New subroutine.

	* keyboard.c (start_polling, stop_polling): New functions.
	(input_poll_signal): New function, handles periodic alarms.
	(read_command_char): Turn off polling temporarily.
	* xdisp.c (redisplay): Likewise.
	* process.c (wait_reading_process_input, create_process): Likewise.
	* x11term.h (BLOCK_INPUT, UNBLOCK_INPUT): Likewise.
	* xterm.c (XTflash, flashback): Likewise.

	* process.c (wait_reading_process_input): Undo last change.

	* process.c (create_process): Don't turn off handling of SIGCHLD.
	Just set a flag if a signal comes in when not wanted.
	(create_process_sigchld): New signal handler.

Sun Oct 14 15:26:29 1990  Richard Stallman  (rms at mole.ai.mit.edu)

	* alloca.s [new hp assembler]: Avoid putting sp above stack top.

	* crt0.c [new hp assembler]: Double flag_fpa and flag_68881 if %d2!=0.

	* x11term.c: Choose time.h or sys/time.h as in process.c.

	* alloc.c (Fmake_marker): Delete debugging abort.

Thu Oct 11 11:58:40 1990  Richard Stallman  (rms at mole.ai.mit.edu)

	* m-ibmps2-aix.h (LOAD_AVE_TYPE, LOAD_AVE_CVT): Define them.
	(C_DEBUG_SWITCH): Delete -fstrength-reduce.

	* x11term.c (XT_GetDefaults): Try more alternatives for each option.

	* unexmips.c (unexec): Add conditional for MIPS2.

Wed Oct 10 16:36:23 1990  Richard Stallman  (rms at mole.ai.mit.edu)

	* m-iris4d.h (LIBS_MACHINE): Use -lsun, don't use -lPW.

	* unexelf.c: New file.
	* s-usg5-4.h: New file.
	* unexec.c [USG_SHARED_LIBARARIES]: Numerous changes under this cond.
	(copy_text_and_data): New second argument.

	* process.c (wait_reading_process_input): If not using interrupts,
	and using X, check every second for input from X.

Tue Oct  9 14:10:30 1990  Richard Stallman  (rms at mole.ai.mit.edu)

	* x11term.c [BAT68K]: Include sys/time.h.
	(x_clear_end_of_line): Fix typo inside #ifdef.

	* m-delta.h: Never use HAVE_ALLOCA.
	Don't define HAVE_SOCKETS.
	Don't alter HAVE_X_WINDOWS or X11.
	Other changes inside HAVE_X_WINDOW conditional.

	* window.c (window_loop): In case 6, don't do Fset_buffer.

	* m-news-risc.h: New file.

	* dispnew.c (init_display): Cast result of egetenv.

	* m-ibmrt-aix.h (PTY_TTY_NAME_SPRINTF): Use fd, not ptyv.

Mon Oct  8 18:55:20 1990  Richard Stallman  (rms at mole.ai.mit.edu)

	* sysdep.c (sys_open, sys_close, sys_read, sys_write):
	Don't handle EAGAIN.

	* process.c (wait_reading_process_input): Handle nread==-1
	for O_NDELAY like O_NONBLOCK.  See james@bigtex.cactus.org.

	* s-vms.h (LINK_CTRL_SHARE): Turn on again.
	tranle@intellicorp.com found it needed in VMS 5.3.

	* emacs.c (main): Move VMS declaration of environ outside function.

	* vmsfns.c (Fdefault_subproc_input_handler): InsCstr -> insert.

Sun Oct  7 22:48:33 1990  Richard Stallman  (rms at mole.ai.mit.edu)

	* m-pmax.h (START_FILES): Handle crt0.o in different dir in Ultrix 4.0.

	* s-sunos4.h (O_NDELAY): Define only if not defined.

Mon Oct  1 13:51:03 1990  Richard Stallman  (rms at mole.ai.mit.edu)

	* sysdep.c (sys_open, sys_close, sys_read, sys_write):
	Handle EAGAIN like EINTR.

Sun Sep 30 16:37:26 1990  Richard Stallman  (rms at mole.ai.mit.edu)

	* sysdep.c: Include various headers for ptys, for hpux, aix, and sysv.

	* dispnew.c (preserve_other_columns): Fix args to second bcopy.

	* term.c (output_chars): Fix braino updating len after TS_repeat.

Sat Sep 29 00:04:31 1990  Richard Stallman  (rms at mole.ai.mit.edu)

	* x11fns.c (Fcoordinates_in_window_p): Don't fail in minibuffer.

	* x11term.c (internal_socket_read): Backwards if in FocusOut. 

	* term.c (fatal): Declare argument str.

	* alloca.s: Handle ns32000 like ns16000.

	* ymakefile (LIB_X11_LIB): New parameter,default -lX11.
	(LIBX): Use that.

	* Makefile (xmakefile): Delete junk.c at the beginning.

	* process.c (sigchld_handler): Don't clear bit in wait mask
	if process is deactivated already.

	* hftctl.c: Include termios.h before termio.h.
	Define TCGETS and TCSETS if nec.
	Give some forward declarations for the static functions.
	Reformat in usual GNU style.

	* m-orion105.h (LOAD_AVE_TYPE, FSCALE): Changed from double and 1.0.

	* xkeys-aix.h: Don't modify delete and backspace.
	If the user has already remapped the keyboard,
	this would only mess things up.

	* m-delta.h: New file.

Fri Sep 28 17:57:46 1990  Richard Stallman  (rms at mole.ai.mit.edu)

	* malloc.c (morecore): Don't block SIGTRAP, SIGILL, SIGSTOP, SIGTSTP.

	* Eliminate all mallocs in signal handlers.

	* process.h (struct process): New slots raw_status_low, raw_status_high
	* process.c (sigchld_handler): Don't compute status list here.
	Just set raw_status_...
	(update_status): New function; compute status from raw_status_...
	(make_process, Fdelete_process, Fprocess_status):
	(Fprocess_exit_status, list_processes_1, wait_reading_process_input):
	(send_process, process_send_signal, sigchld_handler, status_notify):
	Set or test raw_status...

	* dispnew.c (window_change_signal): Don't do it, just make it pending.
	(do_pending_window_change): New function.  Really change the size.
	(hold_window_change, unhold_window_change): Functions deleted.
	* xdisp.c (redisplay, message, message1): Use do_pending_window_change.
	* process.c (wait_reading_process_output): Likewise, after select.

	* alloc.c (malloc_warning): Just save the string.
	(pending_malloc_warning): New variable.
	(display_malloc_warning): Really display the message in a buffer.
	* keyboard.c (command_loop_1): Call display_malloc_warning if needed.

	* fns.c (Frequire): Undo certain things on failure, like autoload.

Thu Sep 27 20:59:54 1990  Richard Stallman  (rms at mole.ai.mit.edu)

	* sysdep.c (select): Use process_tick and update_tick,
	not child_changed.

	* m-convex.h (LIB_STANDARD, LIBS_MACHINE): remove these, they
	cause an unnecessary C1/C2 dependency.

	* m-convex.h (LD_SWITCH_MACHINE): use -e__start to specify
	where crt0.c begins.

	* m-convex.h (HAVE_SETSID): define; must call setsid()
	when creating an inferior with a different controlling tty.
	* process.c (create_process): rearrange so that HAVE_SETSID
	will be seen when not under USG.

	* m-convex.h (S_IFMT etc): define in case of posix compilation.

	* m-convex.h (FIRST_PTY_LETTER): do it at runtime.
	* unexconvex.c (first_pty_letter): routine to locate lowest pty.

	* unexconvex.c: Rewrite so it can cope with thread-local sections.

	* m-sequent.h, m-cydra5.h, m-ibmrt-aix.h: Change ptyname to pty_name.

	* alloc.c (Fmake_marker): Abort if called from signal handler.

Wed Sep 26 18:39:42 1990  Richard Stallman  (rms at mole.ai.mit.edu)

	* m-mips4.h: New file.

Sun Sep 23 14:25:45 1990  Richard Stallman  (rms at mole.ai.mit.edu)

	* keyboard.c (Fsuspend_emacs): Check screen size after resume.

Tue Sep 18 09:21:44 1990  Richard Stallman  (rms at mole.ai.mit.edu)

	* window.c (Fsplit_window): For horizontal split, put excess
	column on left.

Mon Sep 17 11:22:45 1990  Richard Stallman  (rms at mole.ai.mit.edu)

	* emacs.c (main) [USG_SHARED_LIBRARIES]: Call brk.

Sun Sep 16 22:23:10 1990  Richard Stallman  (rms at mole.ai.mit.edu)

	* window.c (save_window_save): New arg MAXWINDOW.
	(Fcurrent_window_configuration): Pass that arg.

Tue Sep 11 16:25:53 1990  Richard Stallman  (rms at mole.ai.mit.edu)

	* unexaix.c, m-ibmr2.h, s-aix3-1.h, xkeys-aix.h: New files.

	* ymakefile (LD): Allow override with LINKER.
	(mallocobj): Handle SYSTEM_MALLOC without HAVE_ALLOCA.
	(xemacs): Use -nl option if HAVE_SHM.

	* x11term.c (XMOD_Alt, ...): New static variables.
	(stringFuncVal): Don't define it if AIX.
	(internal_socket_read): Don't map function keys if AIX.
	Handle ControlMask like Mod1Mask.
	(XInitWindow): If AIX, insert xkeys-aix.h.

	* sysdep.c: Change IBMRTAIX conditionals to AIX.
	Move hft.h to the top.
	[IBMR2AIX]: Use termios.h and change macros accordingly.
	(child_setup_tty): Change IBMRTAIX to AIX.
	(setpgrp_of_tty): Handle IBMR2AIX.
	(init_sys_modes): Handle IBMR2AIX.  Output special things for AIX.
	(reset_sys_modes): Output special things for AIX.
	(hft_init, hft_reset): Conditionals for IBMR2AIX.

	* process.c: Change IBMRTAIX to AIX controlling time.h.
	[AIX]: Include sys/pty.h and unistd.h.
	(wait_reading_process_input): If AIX, handle EBADF differently.
	(create_process): Handle HAVE_SETSID.  Change conditional to AIX.

	* lisp.h (XPNTR): New definition if HAVE_SHM.
	(NULL): Undef before defining.

	* emacs.c (main): If HAVE_SHM, call map_in_data.
	Use AIX, not IBMRTAIX, for signal conditional.
	(Fdump_emacs_data): New function if HAVE_SHM.
	(Fdump_emacs): Don't define if HAVE_SHM.

	* alloc.c (pure, PUREBEG): If HAVE_SHM, define place for a segment.

Thu Sep  6 00:01:05 1990  Chris Hanson  (cph at kleph)

	* x11term.c (CursorToggle): If the cursor is in the modeline,
	don't display it, just say we did.

	* process.c (wait_reading_process_input): Don't initialize
	`Available'.
	(sigchld_handler): Take the process input channel out of
	`input_wait_mask' if the process has died.
	(init_process): Must initialize `input_wait_mask' to contain
	standard input.

Mon Sep  3 14:00:11 1990  Richard Stallman  (rms at mole.ai.mit.edu)

	* process.c: Use fd_set for args of select, if appropriate.
	(SELECT_TYPE): Always define this as type to use.
	(FD_SET, FD_CLR, FD_ISSET, FD_ZERO): New access macros.
	(input_wait_mask): Use SELECT_TYPE.  All refs changed.
	(wait_reading_process_input): Use SELECT_TYPE and new macros.

	* x11term.c (CursorToggle): Abort if on inverse-video line.

Tue Aug 28 23:15:12 1990  Richard Stallman  (rms at mole.ai.mit.edu)

	* regex.c (re_match_2): For case duplicate, refuse to match
	a register with invalid contents.

Tue Aug 28 17:01:40 1990  Chris Hanson  (cph at kleph)

	* dispnew.c (N_PREEMPTIONS): remove illegal semicolon from
	definition.
	(update_screen): fix typo, `num_input_characters' should be
	`num_input_chars'.
	Initialize preemption-debugging variables to impossible values so
	that they are disabled.

Tue Aug 28 15:10:28 1990  Richard Stallman  (rms at mole.ai.mit.edu)

	* regex.c (re_search_2): Propagate serious error indication.

	* dispnew.c (scroll_screen_lines): Mark newly empty lines as empty.
	(scrolling): Give up if any line in current_screen not enabled.

Mon Aug 27 12:42:22 1990  Richard Stallman  (rms at mole.ai.mit.edu)

	* lread.c (load_unwind): Free the stream object.

	* sysdep.c (wait_for_kbd_input): Frob waiting_for_input here.
	* keyboard.c (kbd_buffer_read_command_char): Not here.

	* sysdep.c (wait_for_kbd_input): Clear process_ef before snarfing
	process input.

	* fileio.c (Fdirectory_file_name): On VMS, leave space for log name.

	* sysdep.c (init_sys_modes): Clear process_ef only the first time.

	* vmsfns.c (process_exit): Logic of deletion was wrong.
	(Fspawn_subprocess): Correctly reuse existing struct process_list.

Sun Aug 26 22:09:23 1990  Richard Stallman  (rms at mole.ai.mit.edu)

	* dispnew.c (update_screen): Record preemption events
	in special history array `preemptions'.
	Let programmer force a preemption from the debugger.

Sat Aug 25 14:22:39 1990  Richard Stallman  (rms at mole.ai.mit.edu)

	* xdisp.c (try_window_id): Record info for debugging.

	* x11term.c (CursorToggle): If in highlighted line, call dummy.

Thu Aug 23 16:41:11 1990  Richard Stallman  (rms at mole.ai.mit.edu)

	* process.c (wait_reading_process_output):
	Don't deactivate process for eof if SIGCHLD is defined.
	That used to mask the proper exit status.

Wed Aug 22 12:40:29 1990  Richard Stallman  (rms at mole.ai.mit.edu)

	* m-plexus.h (LD_SWITCH_MACHINE): New macro.

Mon Aug 20 23:29:08 1990  Richard Stallman  (rms at mole.ai.mit.edu)

	* malloc.c (malloc_usable_size, memalign): Count size of header
	properly.

Thu Aug 16 13:51:23 1990  Richard Stallman  (rms at mole.ai.mit.edu)

	* keymap.c (apropos1): At least 1 space between fn name and keys.

Wed Aug 15 14:44:12 1990  Richard Stallman  (rms at mole.ai.mit.edu)

	* term.c (calculate_costs): Make DC_ICcost one element larger.

	* process.c (allocate_pty, create_process): 
	(Fopen_network_stream, wait_reading_process_input):
	Use O_NONBLOCK if it is defined.
	(wait_reading_process_input): Ignore nread == 0 if using O_NDELAY.

	* process.c (pty_name): New name for ptyname.

Tue Aug 14 22:13:00 1990  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* fileio.c (Finsert_file_contents): Ensure `i' appears initialized.

	* process.c (create_process) [HPUX]: Avoid calling signal;
	HPUX has sigsetmask.

Mon Aug 13 18:32:16 1990  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* x11term.c (x_term_init): Turn off use of XIgnoreError.
	(internal_socket_read): Turn off O_NDELAY if FIOSNBIO will be used.

	* xmenu.c (list_of_items, list_of_panes): Fix typos in wta errors.

Sat Aug 11 19:00:49 1990  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* m-convex.h (C_SWITCH_MACHINE, LIB_STANDARD, LIBS_MACHINE):
	(LD_SWITCH_MACHINE): Add definitions for Convex V 4.0.

Wed Aug  8 13:50:25 1990  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* x11term.c (internal_socket_read): Make XComposeStatus static.

Tue Aug  7 16:11:57 1990  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* sysdep.c [NEED_PTEM_H]: New flag macro says include ptem.h.

	* x11term.c (XTfeep): Call XFlush.

	* x11term.c (XT_Set_Size_Hints): Move resize after setting hints.

Mon Aug  6 23:48:00 1990  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* x11fns.c (Fx_set_background_color): Set bkgd color of cursor GC.

Sun Jul 29 14:16:05 1990  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* x11term.c (local_cursor_vpos, local_cursor_hpos): 
	New variables, used throughout this file instead of cursor_*.
	(XTupdate_end): Move cursor to last specified position.
	This makes cursor_in_echo_area work.

	* Makefile (CPP): Use $(CC).

	* editfns.c (init_editfns): Fix typos.

Sat Jul 28 22:14:16 1990  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* doprnt.c (doprnt): Support negative width for %s.

Fri Jul 27 17:15:20 1990  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* dispnew.c (change_screen_size): Set screen_garbaged.

Mon Jul 23 15:51:01 1990  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* scroll.c (CalcLID): Run loop screen_height times.
	(calculate_scrolling): Offset *_cost by -1.

Tue Jul 17 17:42:46 1990  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* m-mips.h: Fix unterminated comment.

	* fileio.c (Finsert_file_contents): Initialize I exiting main loop.

	* fileio.c (barf_or_query_if_file_exists): Fix bad arg to Fsignal.

Tue Jul 10 15:54:25 1990  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* process.c (wait_reading_process_input):
	Test of wait_proc->status was backwards.

	* sysdep.c: New parameter NO_SIOCTL_H.
	* s-386ix.h: New file.

Mon Jul  9 14:33:07 1990  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* m-pmax.h: Undef LD_SWITCH_MACHINE, change DATA_START
	and DATA_SEG_BITS.

Thu Jul  5 15:34:31 1990  Richard Stallman  (rms at mole.ai.mit.edu)

	* s-iris3-6.h (HAVE_GETWD): Define this.
	(KERNEL_FILE): Change to /unix.
	(sigsetmask, sigblock, NEED_ERRNO, C_SWITCH_MACHINE): Turn off.
	(SIGIO): Don't undefine it.
	(LIBS_MACHINE): Remove -lbsd.

	* term.c (calculate_costs): Fix typo allocating DC_ICcost.

Thu Jul  5 13:38:24 1990  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* minibuf.c (Fall_completions, do_completion): Treat nil as alist.
	(Ftry_completion): Likewise.

Sun Jul  1 17:21:40 1990  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* sysdep.c: Undefine TIOCGETC if BROKEN_TIOCGETC defined.
	* s-usg5-3.h: Define BROKEN_TIOCGETC.

Thu Jun 28 13:44:46 1990  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* term.c (calculate_costs): Always allocate chars_wasted and copybuf.
	Clear chars_wasted.

	* xdisp.c (display_text_line): Check p1prev against startp for `...'.

Tue Jun 26 12:37:45 1990  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* fileio.c (Fdo_auto_save): If don't save because file has shrunk,
	that still counts as trying.

Sun Jun 24 14:30:17 1990  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* x11term.c (dumprectangle, CursorToggle, dumpchars): Use new
	screen data structures.
	* xterm.c (dumprectangle, CursorToggle, dumpchars): Likewise.
	Also, use current_screen in place of active_screen
	since in fact only that screen matrix was ever used.

	* dispextern.h: Add `extern' to variable declarations.

Sat Jun 23 14:12:01 1990  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* process.c [HPUX]: Undefine TIOCGPGRP.

	* editfns.c, fileio.c, filelock.c [HPUX]: Include stdio.h.

	* s-hpux.h: Inclusion of wait.h moved from m-hp9000s300.h.
	(HAVE_RENAME): Define this.
	* sysdep.c (HAVE_RANDOM): Define this on hpux with x11.
	(rename): Check HAVE_RENAME.

	* lread.c (read_escape): Don't use \a.

Wed Jun 20 12:44:16 1990  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* m-sun2.h: Add comment for dealing with 68881.

Tue Jun 19 01:36:26 1990  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* m-ibmps2-aix.h: Define C_DEBUG_SWITCH to optimize for gcc.
	Define LIB_STANDARD rather than LIBS_MACHINE.
	Define HAVE_PTYS, HAVE_SOCKETS, HAVE_SYSVIPC, X_DEFAULT_FONT.
	Undefine sigsetmask.

	* sysdep.c: Don't include sioctl.h on aix386.

	* process.c: Use HAVE_WAIT_HEADER.

Sun Jun 17 17:57:31 1990  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* insdel.c (insert): Error if buffer would get too long.
	* fileio.c (Finsert_file_contents): Likewise.

Sat Jun 16 23:31:41 1990  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* syntax.c (scan_lists, scan_sexps_forward): Allow Squote in symbols.

Sun May 27 18:33:35 1990  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* process.h (struct Lisp_Process): Add element pty_flag.
	* process.c (create_process): Initialize that.
	(process_send_signal): Ignore current_process if no pty.

	* syntax.c (scan_sexps_forward): Initialize curlevel->last.

Sat May 26 03:15:22 1990  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* keyboard.c (command_loop_1): Clear this_command_key_count here.
	(Fread_key_sequence): And here.
	(read_key_sequence): Not here.

	* indent.c (current_column): Detect special case when point == BEGV.

	* window.c (unshow_buffer): Don't set pt in selected window's buffer.

	* process.c (status_message): Fix screwup in Qexit case.

Fri May 25 15:10:30 1990  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* dispnew.c (update_screen):
	Add missing else in handling cursor_in_echo_area.

	* window.c (Fselect_window): Always get point from the new window.
	* xdisp.c (redisplay_window): Eliminate lpoint.  Alter opoint 
	if point should be changed permanently in the selected window.

	* xdisp.c (decode_mode_spec): Don't truncate buffer or file name.

	* editfns.c (Finsert_buffer_substring): Don't fail to set beg, end.

	* dispnew.c (safe_bcopy): Fix backwards conditional.
	Do both cases explicitly; don't use bcopy.
	(scroll_screen_lines): Fix amount to rotate by for AMOUNT < 0.

Tue May 22 20:50:33 1990  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* Renamings: Renamed functions include
	move_cursor, bell, read_command_char, insert, output_chars, 
	self_insert_internal, set_buffer_internal.
	Variables echo_area_contents, cursor_hpos, cursor_vpos, meta_key,
	update_mode_lines, current_buffer.
	Macros SET_PT, FROM_KBD, FETCH_CHARS.

	* keyboard.c (defkey): Function deleted.  ndefkey used instead.
	(Vglobal_map, global_map, Vesc_map, Vctl_x_map): Now type Lisp_Object.

Mon May 21 14:32:37 1990  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* buffer.h (struct buffer_text): Component renamed.
	All refs changed to macros below.
	(MODIFF, BUF_MODIFF): New macros.

	* xdisp.c (redisplay_window): Fix backward conditional on point_vpos.

	* xdisp.c (redisplay_window): Set bf_cur directly.
	* buffer.c (SetBfx): Function deleted.

Sun May 20 17:27:06 1990  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* keyboard.c (command_loop_level): New variable.
	Used in place of RecurseDepth, but different meaning.
	(recursive_edit_1): New function.
	(Frecursive_edit): Call that.
	* minibuf.c (read_minibuf): Call recursive_edit_1.
	* xdisp.c (RecurseDepth): Variable deleted.

	* print.c: Include dispextern.h.
	(printchar, strout): Use message_buf.

	* scroll.c (CalcIDCosts): Dynamically allocate ILcost, etc.
	(ILcost, DLcost, ILncost, DLncost): Now pointers.
	(do_scrolling): Use alloca for queue.

	* term.c (calculate_costs):
	Dynamically allocate chars_wasted, copybuf, DC_ICcost.
	Set RPov based on actual width.
	(chars_wasted, copybuf, DC_ICcost): Now pointers.

	* term.c (term_init): Don't use MScreenWidth, MScreenLength at all.
	* sysdep.c (get_screen_size): Likewise.
	* dispnew.c (change_screen_size_1): Likewise.

	* dispnew.c (remake_screen_structures): Allocate message_buf.
	* xdisp.c (message_buf): Now is a pointer.

Sat May 19 15:10:11 1990  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* keyboard.c (get_char): Don't echo dash if have other echo area text.

Fri May 18 15:03:06 1990  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* lread.c (openp): Fix error setting fd after failing `access'.

	* dired.c (file_name_completion): Use scmp to compare names.

	* sysdep.c (setup_pty): New function.

Thu May 17 15:58:05 1990  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* malloc.c (calloc): New function.

	* minibuf.c (Fall_completions): Protect STRING from gc.
	Copy ALIST to TAIL to protect it.

	* paths.h-dist: Doc fix.

	* process.h (struct Lisp_Process): New components status
	contains process status in Lispy form.  Replaces flags and reason.
	New components tick and update_tick record need for attention.
	* process.c: All references updated.
	(status_convert, decode_status, status_message): New functions.
	(pty): Return a descriptor or -1.
	(send_process): Function deleted.
	(send_process_1): Renamed to send_process.
	(process_send_signal, sigchld_handler, status_notify): Renamed fns.
	* sysdep.c (setup_pty): New function.

	* print.c (internal_with_output_to_temp_buffer):
	Save and restore the current buffer.

Sat May 12 18:09:30 1990  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* process.c (create_process) [not USG]: Put subproc in pgrp 0.

	* buffer.c (SetBfp): Don't bother with selected window or its point.
	* window.c (Fselect_window): Always set pointm of old window. 

Thu May 10 18:20:10 1990  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* dispnew.c (make_screen_structure): Clear out enable vector.

Wed May  9 16:55:30 1990  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* insdel.c (make_gap): Arg is amount of new gap to create.
	All calls changed.

	* buffer.c (Fget_buffer_create):
	-2 in buffer_local_flags means init the slot.

	* buffer.c (SetBfp, Frename_buffer): Local cleanups.

	* buffer.c (Fset_buffer): Check for deleted buffer.
	(SetBfp): Don't check.	
	* print.c (PRINTPREPARE): Use Fset_buffer.

Tue May  8 23:00:00 1990  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* buffer.h (struct text): Represent the buffer dimensions
	with new slots, memory, begv, pt, gpt, zv, z and gap_size.
	(BEGV, etc.): Use new slots.
	(CharAt): Likewise.
	(BufferSafeCeiling, BufferSafeFloor): Use new slots; fix old bugs.
	(bf_p1, bf_s1, etc.): Old macros deleted.

	* buffer.c (Fget_buffer_create): Set up memory and new slots.
	(Fkill_buffer): Likewise.

	* insdel.c (move_gap, gap_left, gap_right, make_gap): Update new slots.
	(del_range, InsCStr): Likewise.
	* fileio.c (Finsert_file_contents): Likewise.
	* window.c (temp_output_buffer_show): Likewise.
	* xdisp.c (decode_mode_spec, try_window_id): Likewise.

	* buffer.c (ModExist): Function deleted.

	* buffer.h (struct buffer): Make the syntax table a Lisp object.
	* alloc.c (mark_buffer): No need to treat it specially.
	* syntax.c (Fsyntax_table, Fset_syntax_table, Fdescribe_syntax):
	(Fmodify_syntax_entry): Adjust for this change.
	* buffer.c (reset_buffer_local_variables): Need not be special.
	(init_buffer_once): Make this slot a defaulted local variable.
	* syntax.h: Adjust macros for this change.
	(Vstandard_syntax_table): Define as macro, in buffer_defaults.
	* syntax.c (syms_of_syntax): Don't staticpro it here.
	(Fset_syntax_table): Set the flag in local_var_flags.

	* marker.c (Fset_marker): Don't unchain marker if has no buffer.
	(set_marker_restricted): Likewise.
	* alloc.c (gc_sweep): Likewise.
	* editfns.c (save_excursion_restore): Likewise.

	* editfns.c (insert1): New function.
	* keyboard.c (get_char): Echo area message turns off echoing.

	* keyboard.c (record_auto_save): New function.
	* fileio.c (Fdo_auto_save): Call it.

	* dispnew.c (rotate_vector): Was rotating backwards.

	* insdel.c (make_gap): Complete rewrite.
	(gap_left): New argument NEWGAP.

Sat May  5 13:00:00 1990  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* search.c (skip_chars): Eliminate PointLeft and PointRight.
	* cmds.c (SelfInsert): Likewise.

	* search.c (Flooking_at, search_buffer): Use new accessors.
	* indent.c (Fcurrent_column): Likewise.
	* minibuf.c (read_minibuf): Likewise.
	* regex.c (re_match_2): Use PTR_CHAR_POS.
	* editfns.c (Fbuffer_size, Fnarrow_to_region, Fbuffer_substring):
	(Fbuffer_string, Finsert_buffer_substring): Likewise.
	(save_restriction_restore): Likewise.
	* dispnew.c (direct_output_for_insert): Likewise.
	* fileio.c (Fwrite_region, Finsert_file_contents): Likewise.
	(Fdo_auto_save): Likewise.
	* insdel.c (move_gap, gap_left, gap_right, make_gap): Likewise.
	(InsCStr, del_range, modify_region): Likewise.
	* process.c (Fprocess_send_region): Likewise.
	* xdisp.c (try_window, try_window_id, display_text_line): Likewise.
	(redisplay): Likewise.
	* buffer.c (list_buffers_1): Likewise.
	* marker.c (marker_position, Fset_marker, set_marker_restricted): 
	(Fmarker_position): Likewise.
	* window.c (unshow_buffer, Fset_window_configuration): Likewise.
	(Fset_window_buffer): Likewise.

	* editfns.c (save_restriction_restore): Use a macro to alter point.

	* lread.c (readchar): Use new accessors, and avoid knowing about
	the text field of a buffer.
	* window.c (Fpos_visible_in_window_p): Likewise.

Thu May  3 1990  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* editfns.c (init_editfns): Store system and user names as
	strings to avoid arbitrary limits.

	* keymap.c (describe_vector, describe_alist): Make elt_prefix
	and elt_describer responsible for indentation and newlines.
	Local cleanups.
	(describe_command): Do indentation and newline.
	(describe_map): Add space to end of prefix.
	* syntax.c (describe_syntax): Do indentation and newline.

	* keymap.c (Fdefine_key, Flookup_key): Local cleanups.

	* xdisp.c (redisplay_window): Fix calls to try_window.

	* term.c (write_chars): Local cleanup.
	(term_init): Local cleanup.
	For c100, substitute only in the cm string.
	No need to keep the address of the start of the string area.

	* editfns.c: Eliminate all use of DEFSIMPLE and DEFPRED.
	* dispnew.c, indent.c, keyboard.c: Likewise.

Mon Apr 30 20:00:00  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* sysdep.c (sys_suspend): Use save_signal_handlers and 
	restore_signal_handlers to save and restore signal state.

	* indent.c (Findent_to): Merge guts of indentation into here.
	(position_indentation): Scan with a pointer, for speed.

	* casefiddle.c (operate_on_word): Just return the other end.
	(Fupcase_word, Fdowncase_word, Fcapitalize_word):
	Pass that value to casify_region.

Wed Apr 25 15:10:00 1990  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* keymap.c: Minor changes.

	* lread.c (Fload): Minor changes.

	* macros.c (Fstart_kbd_macro): Local cleanup.

	* minibuf.c (read_minibuf): Local cleanup.

	* search.c (Freplace_match, Fregexp_quote): Local cleanups.

	* search.c (Fstore_match_data): Handle ints and markers properly.

	* syntax.c: Flush incorrect comment.

	* sysdep.c (init_baud_rate, init_sys_modes, tabs_safe_p):
	(get_screen_size): Local cleanups.

	* data.c (Fstring_to_int): Delete disabled feature
	of accepting `yes' and `no'.

	* dispnew.c (current_screen, new_screen, temp_screen): New vars.
	(remake_screen_structures, make_screen_structure):
	(free_screen_structure): New functions.
	(make_display_lines, new_display_line, return_display_line):
	Functions deleted.
	(change_screen_size_1, init_display): Use the new functions.
	(cancel_line, clear_screen_records, get_display_line):
	Rewritten for new data structures.
	(preserve_other_columns, preserve_my_columns): Likewise.
	(cancel_my_columns, direct_output*): Likewise.
	(update_screen, update_line, quit_error_check, scrolling): Likewise.
	(scroll_screen_lines): Likewise.
	(rotate_vector, safe_bcopy): New subroutines.
	* scroll.c (do_scrolling): Rewritten for new data structures.
	* xdisp.c (display_minibuf_message, redisplay): Likewise.
	(display_text_line, display_mode_line): Likewise.
	(display_mode_element, display_string): Likewise.

	* xdisp.c (decode_mode_spec): Local cleanups.
	(display_mode_element): Pass proper arg MAXWIDTH to decode_mode_spec.
	(display_text_line): Pointers now unsigned.

	* dispnew.c (line_hash_code, line_draw_cost): Cleaned up.
	Args are different, and hash computation too.

	* dispnew.c (update_screen): Rearrange buffer-emptying code.

	* editfns.c (in_accessible_range): New function.
	(Fgoto_char, save_restriction_restore): Use it.
	(save_excursion_save, Fcurrent_time_string): Local cleanups.

	* emacs.c (Fkill_emacs): Don't ask any questions.
	* process.c (Fprocess_kill_without_query): New arg; new return value.
	(count_active_processes): Function deleted.

	* emacs.c (Fdump_emacs): Local cleanup.

	* fileio.c (Finsert_file, Fwrite_region): Local cleanups.

	* fns.c (Fsubstring): Local cleanup.

	* keyboard.c (echo_prompt, echo_char, echo_dash, echo): New functions.
	(cancel_echoing): Likewise.
	(immediate_echo, echoptr): New variables.
	(command_loop_1, request_echo, get_char, read_key_sequence): 
	(set_waiting_for_input, interrupt_signal): Related changes.

	* keyboard.c (this_command_key...): New variables.
	(Fexecute_extended_command, Fthis_command_keys): Related changes.
	(init_keyboard, get_char): Likewise.

	* keyboard.c (get_char): New way to decide when to auto-save.
	Other local cleanups.
	(command_loop_1): New criterion for undo boundary.

Tue Apr 24 12:00:00 1990  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* buffer.c (bf_text): Variable deleted.
	(Fkill_buffer, SetBfp): Delete code that worked with it.
	* editfns.c (Fwiden, Fnarrow_to_region): Related changes.
	(save_restriction_save, save_restriction_restore): Likewise.
	(Finsert_buffer_substring): Likewise.
	* fileio.c (Fdo_auto_save): Likewise.
	* insdel.c (make_gap): Likewise.
	* lread.c (readchar): Likewise.
	* marker.c (Fmarker_position, marker_position): Likewise.
	(Fset_marker, set_marker_restricted): Likewise.
	* window.c (Fset_window_buffer, Fpos_visible_in_window_p): Likewise.
	* xdisp.c (redisplay): Likewise.

	* xdisp.c (redisplay, redisplay_preserve_echo_area):
	Two functions replace DoDsp.  All callers changed.

	* xdisp.c (redisplay, redisplay_window): Eliminate `inhibit_hairy_id'.
	(redisplay_window): No return value.  Local cleanups.

	* xdisp.c: Fix various inaccurate comments.

	* xdisp.c (try_window): No return value.

Sat Apr 21 18:05:19 1990  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* sysdep.c (random, srandom): Don't define if HAVE_RANDOM.

Thu Apr 19 12:00:00 1990  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* abbrev.c (Fdefine_mode_abbrev): Clean up error message.

	* alloc.c (Fmake_marker): Delete `modified' field.
	* insdel.c (adjust_markers): Likewise.

	* undo.c: Complete rewrite.
	* undo.h: File deleted.
	* alloc.c (Fgarbage_collect): Call truncate_undo_list.
	(syms_of_alloc): Define vars undo-threshold and undo-high-threshold.
	* buffer.c (Fget_buffer_create): Set undo_list to t or nil.
	(Fbuffer_flush_undo, Fbuffer_enable_undo): Likewise.
	(Fkill_buffer): Likewise.
	(init_buffer_once): Set up local variable buffer-undo-list.
	(syms_of_buffer): Likewise.
	* fileio.c (Finsert_buffer): Store nil in undo_list.

Tue Apr 17 03:24:01 1990  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* buffer.h (struct buffer): Delete minor_modes.
	* buffer.c (Fget_buffer_create):

Mon Apr 16 13:17:43 1990  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* s-sunos4.h (SYSTEM_MALLOC): Define it.

Sat Apr 14 16:48:21 1990  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* window.c (set_window_height, set_window_width):
	Don't delete top-level windows.

Wed Apr 11 15:10:19 1990  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* sysdep.c [HPUX] (perror): Function deleted.

Tue Apr 10 20:39:46 1990  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* process.c (sig_process): Use TIOCSIGSEND if available.

Fri Mar 30 14:42:10 1990  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* alloc.c (xmalloc, xrealloc): Avoid failure if size is 0.

Wed Mar 21 18:19:12 1990  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* m-sun3.h (C_SWITCH_MACHINE): Use -fsoft.

Thu Mar 15 02:41:53 1990  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* x11term.c (internal_socket_read): Change type of 1st arg to
	XRefreshKeyboardMapping and XLookupString.

	* undo.c (Fundo_more): Fix error message.

Tue Feb 13 18:34:54 1990  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* process.c: If _h_BSDTYPES, include time.h, not sys/time.h.

Thu Feb  1 02:11:41 1990  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* m-ibmps2-aix.h (SIGN_EXTEND_CHAR): Cast to `signed char'.

Thu Jan 18 12:56:06 1990  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* search.c (skip_chars): Never go past edge of buffer.

Mon Jan  8 10:56:42 1990  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* editfns.c (Fchar_after): Set N after coercing marker.

Thu Dec 28 18:12:08 1989  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* process.c (create_process): Unhold SIGCHLD in the child.

Wed Dec 27 19:10:35 1989  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* process.c (create_process): Fix bad HPUX conditional at sigsetmask.

Mon Dec 25 00:10:57 1989  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* x11term.c (internal_socket_read): Handle explicit focus events.
	(XInitWindow): Add them to event mask.

	* fns.c (Fmapconcat): Gcpro SEP around mapcar1.

Fri Dec 15 13:27:03 1989  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* process.c (read_process_output): Return -1 if read does.
	(wait_reading_process_input): Handle EWOULDBLOCK.

Fri Nov 17 17:18:15 1989  Joseph Arceneaux  (jla at spiff)

	* xmenu.c (XEmacsMenu): Use ButtonReleasedMask for X11.

Thu Nov  9 13:10:02 1989  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* m-sparc.h (C_OPTIMIZE_SWITCH): Use -O if GCC.

Wed Nov  8 14:05:37 1989  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* marker.c (Fset_marker): Don't force position into visible range.
	(set_marker_restricted): New function does what Fset_marker did.
	* window.c: Change many calls to use the new function.

	* search.c (Fstore_match_data): Accept integers as well as
	markers.
	A marker pointing nowhere, treat as 0.

Mon Nov  6 02:00:40 1989  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* search.c (Fmatch_data): Report 0 as integer 0;
	don't convert to a marker.

	* m-mips.h [USG]: Undef NOMULTIPLEJOBS.
	Define SYSV_SYSTEM_DIR and undef NONSYSTEM_DIR_LIBRARY.
	Define utimes as alias for utime.  Undef BSTRING.
	[unconditional]: Undef LOAD_AVE_TYPE.
	[BSD]: Define COFF and TERMINFO.
	Undef MAIL_USE_FLOCK and HAVE_UNION_WAIT.
	Define C_SWITCH_SYSTEM and LD_SWITCH_SYSTEM.
	Define START_FILES and LIB_STANDARD as in USG.
	* m-pmax.h: Add stuff to cancel that out.

	* sysdep.c: Handle BROKEN_FIONREAD.

Thu Nov  2 12:30:20 1989  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* alloc.c (staticvec) [__GNUC__]: Make this a simple vector of pointers
	rather than an alias for a vector of chars.

Thu Oct 26 20:24:55 1989  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* x11term.c (x_init_1): Negate arg to fcntl F_SETOWN
	if F_SETOWN_SOCK_NEG.
	* xterm.c (x_init_1): Likewise.
	* keyboard.c (Fset_input_mode) [NO_SOCK_SIGIO]:
	No interrupt input if using a socket.
	* m-sequent.h: Define NO_SOCK_SIGIO, F_SETOWN_SOCK_NEG, MAIL_USE_FLOCK.

Wed Oct 18 17:55:37 1989  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* m-pyramid.h (NO_ARG_ARRAY): Define if using GCC.

Tue Oct 17 03:08:08 1989  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* vmsfns.c (process_command_input): Call clear_waiting_for_input.

Fri Oct 13 20:29:42 1989  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* x11fns.c (Fx_get_mouse_input): Read in all kbd input, to get event.
	* keyboard.c (consume_available_input): New fn that does this.
	(read_avail_input): No longer requires kbd_count == 0.
	Can now be subroutine for consume_available_input.

Wed Oct 11 14:55:23 1989  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* termcap.c (tgetent, gobble_line): Always store null at end of bfr.
	Allocate one extra byte at end to ensure space.
	Clean up order of arithmetic when updating ptrs into buffer
	after xrealloc.

Tue Oct  3 12:29:18 1989  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* m-hp9000s800.h (XUNMARK): Delete definition.

Fri Sep 22 00:40:16 1989  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* x11fns.c (Fx_get_mouse_event): Fix typo, Fcond => Fcons.
	Do set Vx_mouse_item.  Wait using Fsleep_for.
	Convert meta from 8-bit to 2-bit, as in Fx_proc_mouse_event.

Fri Aug 18 17:00:47 1989  Richard Stallman  (rms at hobbes.ai.mit.edu)

	* Version 18.55 released.

	* vmsfns.c: Define PRV$V_... syms if prvdef.h does not.

Sun Aug 13 14:50:28 1989  Richard Stallman  (rms at hobbes.ai.mit.edu)

	* xfns.c (Fx_proc_mouse_event, Fx_get_mouse_event):
	Set new var Vx_mouse_abs_pos, for sake of xmenu.c.
	(syms_of_xfns): Make this a Lisp variable.

	* x11fns.c (Fx_get_mouse_event): Fix like Fx_proc_mouse_event.
	(syms_of_xfns): Initialize the variable.

Fri Aug 11 21:24:19 1989  Richard Stallman  (rms at hobbes.ai.mit.edu)

	* dispnew.c: Handle BROKEN_FIONREAD as in other files.

	* x11fns.c (Fx_proc_mouse_event): Set Vx_mouse_abs_pos right.
	* xmenu.c (XEmacsMenu): Use that rather than XQueryPointer
	to decide where to put the menu.

Sun Aug  6 17:57:54 1989  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* process.c [HPUX, !NOMULTIPLEJOBS, !WAITTYPE]:
	Treat this case like BSD, regarding sys/wait.h.

	* m-hp9000s300.h: Don't include sys/wait.h if NOT_C_CODE.
	If we do include it, also define WRETCODE.
	* alloca.s: Define NOT_C_CODE.

Sat Aug  5 16:25:04 1989  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* m-ibmps2-aix.h (HAVE_CLOSEDIR): Define this.
	* sysdep.c (closedir): Don't define if HAVE_CLOSEDIR.

	* m-hp9000s300.h: Include sys/wait.h and define WAITTYPE, 
	unless NO_SHORTNAMES.

	* process.c [BSD]: If O_NDELAY missing in file.h, include fcntl.h.

Wed Aug  2 20:31:13 1989  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* m-ibmrt-aix.h (LIBS_MACHINE): Delete X libraries--redundant.

	* x11term.c [AIX]: Include sys/time.h as well as time.h.

	* search.c (Freplace_match): Bug in substituting \N if match was empty.

Wed Jul 26 01:41:25 1989  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* sysdep.c (wait_for_termination): Treat HPUX version 6 like BSD.

	* process.c: If NEED_BSDTTY, include bsdtty.h.
	If WAITTYPE already defined, don't include wait.h
	and don't alter the related macros.
	(child_sig): On HPUX, if have WNOHANG, loop around as on BSD.
	(create_process): On HPUX, frob the signal mask as on BSD.

	* m-intel386.h (LOAD_AVE_*): Expect different type and encoding.

Thu Jul 20 00:53:05 1989  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* sysdep.c: Don't include sioctl.h on mips.

	* buffer.c  (Flist_buffers): Pass prefix as arg.

	* editfns.c (Finsert_char): Insert at most 256 chars at a whack.

	* x11term.c (internal_socket_read): Pass 0 as fifth arg
	to XLookupString.

	* keyboard.c (command_loop_1): Finalize keyboard macro storage
	only when there is no prefix argument.

	* callproc.c (Fcall_process) [USG,HAVE_PTYS]:
	With these parameters, do setpgrp here.
	(child_setup): Instead of here.
	Note that process.c already did setpgrp before calling
	child_setup, with these parameters.

	* m-ibmps2-aix.h: New file.
	* m-ibmrt-aix.h: Define AIX.
	* sysdep.c: Change IBMRTAIX to AIX in certain conditionals.
	(Those pertaining to the hf library or system calls.)

Tue Jul  4 21:00:30 1989  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* fileio.c (Finsert_file_contents): Check for negative file length.

Fri Jun 23 15:48:21 1989  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* Makefile (clean, distclean): Delete libXMenu11.a.

Thu Jun 22 18:51:06 1989  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* m-mips.h (LIBS_MACHINE): Don't define if BSD.
	* keyboard.c (force_input_signal): New function: raise SIGIO and force
	read_socket_hook to be called.
	* xmenu.c (Fx_popup_menu): Call that after menu disappears.

Fri Jun 16 22:17:12 1989  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* ymakefile: New var OLDXMENU for filename of libXMenu.a.
	Put it in LIBX, not XOBJ.  Make temacs depend on it.

Thu Jun 15 20:15:29 1989  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* ymakefile [HAVE_X11, HAVE_X_MENU]: Assume Xmenu came with Emacs
	and must be built.

	* xmenu.c: Load "../oldXMenu/XMenu.h" instead of <X11/XMenu.h>.

	* x11term.c (xfixscreen): Really act only every 100th time.

Thu Jun  8 12:54:03 1989  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* m-pmax.h: New file.

Wed Jun  7 13:54:22 1989  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* alloca.s [hp9000s300]: Increase MAXREG for fpregs.

	* sysdep.c (init_sys_modes, reset_sys_modes): Take TIOCGLTC code
	outside of HAVE_TERMIO conditionals.

	* m-hp9000s300.h: Undefine NOMULTIPLEJOBS.
	Define NEED_BSDTTY if not NOMULTIPLEJOBS.

	* crt0.c [hp9000s300]: Set flag_fpa.  Define float_loc.

	* m-hp9000s800.h: Define NEED_BSDTTY here.
	* s-hpux.h: Not here.

Tue Jun  6 19:25:17 1989  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* s-hpux.h: Define NEED_BSDTTY.

Tue May 30 18:45:21 1989  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* x11fns.c (x_set_cursor_colors): Don't let the background match
	the mouse.
	* x11term.c (XFlipColor): Change mous_color earlier.

Tue May 23 22:18:53 1989  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* search.c (skip_chars): Dumb error checking for \.

Sun May 21 00:43:24 1989  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* callproc.c (child_setup): Undo previous change.
	setpgrp is needed on USG.

	* xmenu.c (Fx_popup_menu): Prevent sigio int during XQueryPointer.

Mon May 15 21:59:38 1989  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* editfns.c (Fsubst_char_in_region): If NOUNDO, do increment tick,
	but maybe also increment save-tick.

Sat May 13 14:17:57 1989  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* sysdep.c (init_sys_modes) [IBMRTAIX]: Typo; had s for sg.

Fri May 12 22:09:26 1989  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* s-usg5-3.h: Define HAVE_SYSVIPC.

	* m-7300.h: Undefine SHORTNAMES.

Mon May  1 02:10:04 1989  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* x11term.c [USG]: Use sys/time.h, not time.h, if IRIS_4D.

	* sysdep.c [USG]: Don't include sioctl.h if IRIS_4D.

Wed Apr 26 16:14:12 1989  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* Version 18.54 released.

	* xdisp.c (Fredraw_display): Don't do set_terminal_modes if
	reset_terminal_on_clear is 0.

Tue Apr 25 22:02:48 1989  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* m-news.h: Define m68000 if not defined.

Mon Apr 24 01:26:40 1989  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* m/m-mips.h [USG]: Define LIBS_TERMCAP.
	If HAVE_X11, define HAVE_VFORK.
	Delete defns of XMARKBIT, XSETMARKBIT.
	[BSD]: Add alternative linker switches; don't override sys
	facility options.

	* sysdep.c: Include ioctl.h if mips.

Wed Apr 19 20:26:23 1989  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* ymakefile: use HAVE_X11 as alias for X11.

Tue Apr 18 00:17:46 1989  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* process.c: Don't define wstopsig, wtersig if already defined.

	* sysdep.c [VMS] (sys_getenv): Copy the string before returning it.

	* m-alliant.h: Define `vector'.

Thu Apr 13 12:55:14 1989  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* process.c (wait_reading_process_input) [sun]: If SIGIO failed
	to be sent, send it by hand.

Wed Apr 12 01:42:23 1989  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* window.c (Fdelete_other_windows): recenter window to avoid scrolling.

Tue Apr 11 00:18:10 1989  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* indent.c: Include screen.h.

	* indent.c (pos_tab_offset, Fvertical_motion): Compute internal width
	correctly and uniformly.

	* xdisp.c (try_window, try_window_id): Use exact internal width
	to update tab_offset.
	(try_window_id): pos_tab_offset value needs adjustment only if
	starting a line in middle of a character.

Sat Apr  8 16:38:40 1989  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* sysdep.c [USG]: If TIOCGWINSZ defined, include sioctl.h.

Thu Apr  6 11:52:43 1989  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* eval.c (Fbacktrace): Set Vprint_level to 3 throughout.

	* fns.c (Fload_average): nlist data structure is funny on convex.

	* window.c (scroll_command): scroll at least 1 line in specd direction.

	* cm.c (calccost): NTABS was off by 1 sometimes; take account of
	the starting position modulo 8.

	* fileio.c (Fexpand_file_name): Don't simplify /../ at start of name.

	* callint.c: doc fixes.

	* process.c (create_process):
	On all USG systems, not just IRIS and AIX, don't pre-open pty's tty.
	Move the setpgrp done for USG (no real change).
	Tell child_setup to do a setpgrp.
	* callproc.c (child_setup): New arg says whether to setpgrp.
	Never setpgrp on USG.
	(Fcall_process): Tell child_setup not to setpgrp.

	* sysdep.c (init_sys_modes, reset_sys_modes): Don't try to hack
	TIOCGLTC, TIOCGETC, etc. if HAVE_TERMIO.
	Don't bother to undef these for XENIX.

Mon Apr  3 17:43:28 1989  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* ymakefile (LIBES): Put LIBX first; it may depend on LIBS_MACHINE.

	* m-sequent.h: Define HAVE_ALLOCA.

Sun Apr  2 12:03:53 1989  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* term.c (term_init): Can't use scroll region if no abs positioning.

Sat Apr  1 00:51:52 1989  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* process.c (Fopen_network_stream): close desc. if connect fails.

Fri Mar 31 17:49:53 1989  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* minibuf.c (Fall_completions): gcprotect ALLMATCHES and TAIL,
	not STRING.

	* keyboard.c (read_avail_input): Handle EBADSLT like EAGAIN.

Wed Mar 29 09:13:39 1989  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* term.c (term_init): Either ic or ip or im or IC => can insert chars.

	* minibuf.c (read_minibuf_unwind): Ensure minibuf writable for erasure.

Thu Feb 23 07:03:47 1989  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* m-convex.h: Undefine NO_ARG_ARRAY.
	Changed defns of DATA_SEG_BITS and XINT.
	Define alloca for GCC compilation.

Fri Feb 17 01:47:30 1989  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* m-ibmrt-aix.h: Define BROKEN_FIONREAD.

Thu Feb 16 03:23:31 1989  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* keymap.c (Fdefine_prefix_command): Set both value and fn defn,
	with separate syms specified for each purpose.

Wed Feb 15 22:34:58 1989  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* callproc.c (Fcall_process): Open /dev/null with O_WRONLY.

Tue Feb 14 11:48:44 1989  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* window.c (window_scroll): Allow scrolling to very end (empty screen)
	if that's exactly where we wanted to scroll to.

Sat Feb 11 01:14:39 1989  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* data.c (Fkill_local_variable): New local to simplify big stmt.

Thu Feb  9 06:37:24 1989  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* xdisp.c (display_text_line): cvt chars to glyfs for overlay arrow.

	* sysdep.c (init_sys_modes, child_setup_tty) [IBMRTAIX]:
	Don't ignore BRK, and don't signal it.

	* process.c (pty): An IBMRTAIX conditional.
	(create_process): Another here.

Wed Feb  8 13:24:39 1989  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* keymap.c (Fdefine_prefix_command): Use Ffset, not Fset.

Mon Feb  6 12:58:58 1989  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* fileio.c (Fset_visited_file_modtime): New fn.

	* xfns.c (Fx_create_screen) [X10]: XCreateWindow wants pixmaps as args.

Fri Feb  3 01:16:49 1989  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* dispnew.c (Fsit_for): It accepts 3 args.

Thu Feb  2 23:07:43 1989  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* xterm.c (XTread_socket): For X10, make EVENT an XKeyPressedEvent.
	(x_set_resize_hint): Call XSetResizeHint.

	* process.c: Declare interrupt_input.

	* sysdep.c (init_sys_modes): TIOCSTART, not TCSTART.

Sat Jan 28 15:39:03 1989  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* xterm.h (struct x_display): `GC' renamed `gc' in all field names.
	Field `ColorMap' renamed to `color_map'.
	(face_gc_values): face_GC_values renamed.

Sat Jan 28 15:39:03 1989  Joe Arceneaux  (rms at sugar-bombs.ai.mit.edu)

	* xterm.h (face_GC): Var deleted.
	(struct x_display): New field face_GC.
	(VSCROLL_WIDTH, HSCROLL_WIDTH): Moved here.
	(MINWIDTH, MINHEIGHT, MAXWIDTH, MAXHEIGHT): New vars.  Eliminate them!
	(BLACK_PIX_DEFAULT): Typo in definition.
	(WHITE_PIX_DEFAULT): Typos in definitions; was the black default.

	* xterm.c: Include ioctl.h only if BSD.
	Include termio.h otherwise.
	(XMapWindow) [X11]: Typo in definition.
	(METABIT): New definition; maybe not needed.
	(hostname, id_name, invocation_name, Vcommand_line_args): New vars
	declared for main icon title.
	(x_debug): Init to 1 if XDEBUG defined.
	(dumpglyfs) [X11]: Changed args to XDrawImageString.
	If debugging, do XFlushQueue.
	Use screen's face_gc rather than old global one.
	(XTflash) [not BSD]: avoid `struct itimerval'; use `alarm'.
	(events): New table of event type names.
	(XTread_socket): EVENT is now an XEvent even on x10.
	Translate modifier key 1 into meta-bit.
	For EnterNotify event, don't dumpborder or x_new_selected_screen
	if there is an x_focus_screen.
	For LeaveNotify event, don't ignore due to nonzero subwindow.
	For ConfigureNotify, change screen size.
	Do `select' check for SIGHUP only if HAVE_SELECT.
	(x_new_selected_screen): An arg, SCREEN.
	(x_display_cursor): dumpglyfs args changed.
	(x_draw_box): Add GC arg to XDrawRectangle; change other args.
	(clear_cursor): Change args to XClearArea.
	(dumpborder): check x_input_screen, not selected_screen.
	(x_text_icon): For X11, new arg to XGetDefault.
	Cast values stored in icon_label.
	(x_term_init): Hair to calculate name for icon.
	Don't init_sigio unless SIGIO defined.
	Call Fset_input_mode.
	For X11, new arg to XGetDefault.
	Set _Xdebug if debugging.
	(x_new_font) Use XGetFont.
	Get GC values from the screen structure.
	(x_reset_cursor): Don't call XRecolorCursor.
	(x_set_window_size): Call x_wm_set_size_hint, not x_set_size_hint.
	(x_set_resize_hint): For X11, call x_wm_set_size_hint.
	(x_wm_set_size_hint, x_wm_set_window_state, x_wm_set_icon_pixmap):
	(x_wm_set_icon_position): New fns for X11.

	* xfns.c: For X11, include Xutil.h
	(VSCROLL_WIDTH): Moved to xterm.h.
	(face_GC): Don't declare it.
	(id_name): Declare this.
	(x_decode_color): Check `white' and `black' first of all.
	(x_set_foreground_color) [X11]: Reset foreground and background.
	(x_set_background_color) [X11]: Missing arg to XSetWindowBackground.
	(x_set_cursor_color) [X11]: Reset foreground and background.
	(x_read_mouse_position) [X11]: Changed call to XQueryPointer.
	(x_set_mouse_position) [X11]: Add args to XWarpPointer.
	(Fx_create_screen): Set some temporary geometry parms at the beginning.
	For X11, changed setup of iconidentity, and implement rubber-banding.
	For X11, implement merging individual geometry parms.
	For X11, changed args to XCreateSimpleWindow.
	For X11, call x_wm_set_size_hint.
	Specify name when creating icon.
	Don't call XSetForeground, XSetBackground before making border tile.
	New var `cursor_bits'.  Init the screen's GC's.

	* screen.c (Frubber_band_rectangle): For X11, just return nil.

Tue Jan 24 01:59:31 1989  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* buffer.c (Fbuffer_modified_tick): New fn.

	* window.c (Fnext_window): Accept 3 args from Lisp.

Mon Jan 23 16:39:36 1989  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* sysdep.c (sys_suspend): Handle case of SIGTSTP but not BSD.

Fri Jan 20 14:26:12 1989  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* sysdep.c (init_sys_modes): Do TIOCSTART if def, like TCXONC.

Thu Jan 19 03:04:58 1989  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* process.c (wait_reading_process_input): New 2nd arg is extra usecs.
	All callers changed.
	* dispnew.c (Fsit_for, Fsleep_for): New 2nd arg says 1st arg
	counts in milliseconds.

	* buffer.c (Fkill_all_local_variables): Implement permanent locals.

Wed Jan 18 14:08:35 1989  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* keymap.c (get_keyelt): Allow indirection within (STRING . DEFN).

Mon Jan 16 17:26:08 1989  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* process.c (wait_reading_process_input): If select returns there
	is kbd input, but detect_input_pending can't find it, signal SIGIO.
	This may avoid the X loop-on-logout bug.

	* process.c (wait_reading_process_input): Flush fix_screen_hook.
	* termhooks.h, term.c: likewise.

	* xdisp.c (Fredraw_display): Don't do set_terminal_modes.
	* dispnew.c (Fredraw_screen): likewise.

	* eval.c (Fcond): If no args, return nil.

Sun Jan 15 15:41:13 1989  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* eval.c (Fbacktrace_frame): Require one arg.  Return nil if too high.

Sat Jan 14 17:50:56 1989  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* minibuf.c (read_minibuf): Set Vminibuf_scroll_window before
	switching windows.

	* xterm.c (XTread_socket): If no HAVE_SELECT, wait for input
	if new arg WAITP is non0.  Do this by not bothering to test for
	presence of input before reading some.
	Check for dead connection only if new arg EXPECTED is nonzero.
	All callers changed (keyboard and sysdep).

	* Simplify keyboard input.
	* keyboard.c (read_avail_input): Don't assume buffer is empty.
	Don't call get_input_pending; do FIONREAD here.
	Don't do FIONREAD if read_socket_hook, just tell it don't wait.
	Arg EXPECTED is passed to read_socket_hook.
	(input_available_signal): Use read_avail_input.
	(gobble_input): Use read_avail_input; arg EXPECTED passed along.
	(get_input_pending): let gobble_input do the work.

	* VMS keyboard input should have interrupt_input nonzero.
	* keyboard.c (Fset_input_mode, init_keyboard): [VMS] Always set
	interrupt_input to 1.
	(get_input_pending): Special case deleted.

Fri Jan 13 01:21:00 1989  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* fileio.c (auto_save_1): Always make auto-save file owner-writable.

	* eval.c (Fbacktrace_frame): New fn.

	* buffer.h: Define `fieldlist' field in a buffer.
	* buffer.c (Fregion_fields): Return list of fields overlapping
	specified region.
	(syms_of_buffer): New variable buffer-field-list.
	(reset_buffer): Clear the fieldlist.
	(init_buffer_once): Set up default and flag for buffer-field-list.
	* insdel.c (prepare_to_modify_buffer): If check_protected_fields,
	call Fregion_fields to detect error.
	Delete buffer_modify_hook.

	* callint.c (Fcall_interactively): Bind `command-debug-status'
	for each interactive command.

	* keyboard.c (command_loop_1): Count # commands read.
	(num_input_keys): New Lisp variable.

	* m/m-gould.h, m/m-ibmrt-aix.h, m/m-sequent.h, m/m-sparc.h,
	m/m-sun3.h, m/m-symmetry.h: Define A_TEXT_SEEK.
	* unexec.c (copy_text_and_data): Don't check A_TEXT_OFFSET,
	just A_TEXT_SEEK.
	* unexconvex.c: Likewise.

	* unexconvex.c: machine/*.h unconditionally.

	* process.c (pty): Delete RTU, HPUX, IRIS alternatives to
	PTY_NAME_SPRINTF, PTY_TTY_NAME_SPRINTF.
	* s/s-hpux.h: Define PTY_NAME_SPRINTF, PTY_TTY_NAME_SPRINTF.
	* s/s-rtu.h: Likewise.
	* s/s-iris*.h: Define PTY_TTY_NAME_SPRINTF.

	* sunfns.c (Fsun_change_cursor_icon): Avoid ambiguity in eval order.

Thu Jan 12 18:28:29 1989  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* data.c (Fdefault_value): If var set up with default value as current,
	take the current value slot, more up to date than the default slot.

Wed Jan 11 15:22:14 1989  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* dispnew.c (init_display): don't handle SIGWINCH if using X.

	* fileio.c (Fdo_auto_save): If file has shrunk, turn off auto-save.
	This avoids duplicate messages and allows M-x auto-save to turn it on.

	* lread.c (Fload): Look in Vafter_load_alist.
	(syms_of_load): Define after-load-alist.

Sat Jan  7 01:43:47 1989  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* dired.c (Fdirectory_files): 4th arg NOSORT non-nil means don't sort.

	* syntax.c (scan_lists): Change Sendcomment case so that
	ignoring comments works even for newline-terminated comments.

	* minibuf.c (read_minibuf): Default Vminibuf_scroll_window
	to the window that was selected.

Fri Jan  6 02:51:46 1989  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* fns.c (do_yes_or_no_p): Typo, call2 => call1.

	* eval.c (Fbacktrace): Each frame item should have a newline.

	* emacs.c (Fkill_emacs): Don't run hook if noninteractive.

	* eval.c: Define Vrun_hooks.
	(syms_of_eval): Initialize Vrun_hooks.

	* indent.c (Fmove_to_column): Use del_range; Fdelete_backward non ex.

	* ymakefile (objs, floatfns.o): Re-add this file.
	(LIBX): Install X11 case.

	* ymakefile (LIB_GCC): Now a cpp macro, like all other LIB_...
	Define null if not using GCC.

	* lread.c (unreadchar): New function to unread a char
	by stuffing it back into its stream.  Now unread chars
	work properly between multiple reads.
	(UNREAD): Now calls that function.
	(readchar): Don't us `unrch'; variable deleted.
	(various): Don't initialize `unrch'.
	(readevalloop): No need to save and restore `unrch'.
	(read1): Don't unread a -1.

	* keymap.c (get_keyelt): If keymap defn is (STRING . FOO),
	remove just FOO.  Will help HierarKey.

Thu Jan  5 14:49:14 1989  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* unexmips.c [IRIS_4D]: Don't include fcntl.h.
	(unexec): Look for LIT8, LIT4 sections iff they are defined.

	* buffer.c (Fkill_all_local_variables): Force redisplay of mode lines.

Mon Jan  2 13:52:58 1989  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* emacs.c (main): Do the setpgrp before handling -t.

	* keyboard.c (Fsuspend_emacs): Use run-hooks to run suspend-hook
	and suspend-resume-hook.

	* buffer.c (Fkill_buffer): Execute kill-buffer-hooks
	with buffer to be killed as current buffer.

	* buffer.c (count_modified_buffers): ModExist renamed.

	* emacs.c (Fkill-emacs): Execute kill-emacs-hook.

	* fileio.c (auto_save_1): Set auto_save_mode_bits from visited file.
	(Fwrite_region) [not VMS]: If auto-saving, write file with that mode.

	* fileio.c (Fwrite_region): If START is a string, write that string.

Sun Jan  1 14:00:50 1989  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* lisp.h (XMARKBIT, XSETMARKBIT): If mark bit is sign bit,
	use sign-test for XMARKBIT; value is then 1 or 0.
	Make XSETMARKBIT test 2nd arg for nonzeroness only.

	* m/m-mips.h: Last batch of changes are only for USG.
	(XMARKBIT, XSETMARKBIT): Deleted; the new default ones are good.

	* editfns.c (Fformat): Use princ for %s.
	New format %S converts everything (even strings) with prin1.
	* doprnt.c (doprnt): Treat %s like %S.

	* print.c (Fprin1_to_string): Opt 3nd arg non-nil does princ.

Sat Dec 31 14:18:31 1988  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* data.c (Fstring_to_int): Correct max # args.

Fri Dec 30 02:14:11 1988  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* ymakefile (LIBES, LIB_GCC): If using GCC, link with gnulib.

Thu Dec 29 18:50:10 1988  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* editfns.c: Many doc improvements.

Wed Dec 28 02:34:04 1988  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* lisp.h (CHECK_NATNUM): New macro.

	* indent.c (Fmove_to_column): 2nd arg t means indent till spec'd column
	or change tab to spaces if necessary.

	* m/m-iris4d.h: (conditionally) delete DEFAULT_ENTRY_ADDRESS
	and change START_FILES and LIB_STANDARD.

	* s/s-iris3-6.h: Define sigblock as no-op.

	* m/m-mips.h: Cancel defn of VIRT_ADDR_VARIES, `static'.
	Undef SIGIO.  Define BROKEN_FIONREAD.
	Define various HAVE_... flags a la BSD.
	Add options, libraries for linking and compilation.

	* unexmips.c (unexec): Handle additional optional sections now likely.
	New scheme for recording what sections there are.
	Make handling of the LIT8,LIT4 sections conditional (not on IRIS).

	* fns.c (do_yes_or_no_p): New interface to Lisp function yes-or-no-p.
	Allows the user to redefine that function.
	All callers of Fyes_or_no_p changed.

	* data.c (Fmakunbound): Don't allow nil or t as arg.

	* m/m-orion105.h (LOAD_AVE_TYPE): Now `long'.

Tue Dec 27 23:44:41 1988  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* dispnew.c (unhold_window_change):
	Don't signal SIGWINCH.  Instead, do pending size-changes here,
	while holding any new size-changes that arrive, so they become
	pending.  Loop around to get the new pending ones.
	(change_screen_size): Clear any previous pending size-change.

	* search.c (place): Was clipping to (1- (point-max)) by mistake.

Sat Dec 24 17:45:38 1988  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* window.c (Fdelete_window): Give all this window's space
	to one adjacent sibling.

Fri Dec 23 01:16:18 1988  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* keymap.c (describe_alist): Don't lose on non-cons-cell alist elts.
	(Fwhere_is_internal): Don't fail to step down the alist.
	(Faccessible_keymaps): Considerable confusion in alist case.

	* lread.c (Feval_current_buffer, Feval_region):
	Save and restore point as a marker, not a number.
	Don't restore it at all if printflag is t.

	* print.c (float_to_string): Mostly rewritten; output format
	is now a printf %-spec.
	(Qfloat_output_format): Doc changed to match.

Thu Dec 22 12:22:24 1988  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* ymakefile (obj): Include floatfns.o.
	* data.c (syms_of_data): Fix typo Snumberp_or_marker_p.

	* Allow keymaps to have other keymaps as tails.
	Thus, one keymap can inherit from another.
	* keymap.c (Fwhere_is_internal): Ignore non-cons elements of alist.
	(Faccessible_keymaps): Support symbols as alist indices.
	Ignore alist elements that aren't conses.

	* m/m-sun386.h (LDAV_SYMBOL): Define as "avenrun" with no underscore.

	* lread.c (read_escape): Support ANSI C `\x...' hex escapes.

	* bytecode.c (Fbyte_code): fix jump operators for change in `pc'.

Wed Dec 21 19:39:27 1988  Joe Arceneaux  (jla at gracilis.ai.mit.edu)

	* ymakefile: Commented #endif LISP_FLOAT_TYPE.  Also changed
	the code pertaining to X11 to use the same files as X10.

	* bytecode.c (Fbyte_code): Declared unsigned char *pc.

Mon Dec 19 17:27:14 1988  Joe Arceneaux  (jla at apple-gunkies.ai.mit.edu)

	* xterm.c: Finished a first cut of the X11 version.

Sun Dec 18 13:08:17 1988  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* sysdep.c (select): `buf' is now unsigned char.

Fri Dec 16 18:00:36 1988  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* m/m-elxsi.h: Don't define WORD_MACHINE or CANNOT_DUMP.
	Do define symbols for load average.
	Define COFF and ADJUST_EXEC_HEADER.

Fri Dec 16 13:56:51 1988  Joe Arceneaux  (jla at apple-gunkies.ai.mit.edu)

	* sink.h,sinkmask.h: Same file now works for both X10 and X11.
	* xterm.c,xfns.c (x_text_icon) Can now take new name as parameter.

Fri Dec 16 11:07:20 1988  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* m/m-is386.h: No need to undef HAVE_PTYS, HAVE_SOCKETS, SYSV_PTYS
	since s-usg5-3.h no longer defines them.

Wed Dec 14 17:52:51 1988  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* bytecode.el (Fbyte_code): Cache the pointer in the string
	to avoid recalculating it at each fetch.
	Also turn off the error check for stack overflow/underflow.

Wed Dec 14 14:51:24 1988  Joe Arceneaux  (jla at apple-gunkies.ai.mit.edu)

	* xfns.c: Made the first cut for X11 version.
	* xterm.c: (x_reset_cursor) Did the X11 version.

Wed Dec 14 13:02:30 1988  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* keyboard.c (Fexecute_mouse_event): Set Vmouse_event.  Doc fix.
	Run Vmouse_hook at the end.
	(syms_of_keyboard): Define var `mouse-hook'.

Tue Dec 13 10:55:27 1988  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* term.c (insert_glyfs): Typo, was fetching G twice.

Sat Dec 10 17:37:28 1988  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* keymap.c (describe_buffer_bindings): Print mouse bindings too.
	(describe_map): If have a chartab, use mouse-describe-key for prefixes.
	* keymap.c (describe_{map,map_tree,alist}, describe_vector):
	Extra arg mapping chars to their names.  Calls changed.
	* syntax.c (describe_syntax_1): Call changed.

	* keymap.c (Vglobal_mouse_map): Make it exist unconditionally.

	* keymap.c (apropos1): Clean up.
	Do where-is-internal only if there is a function definition.
	Use mouse-describe-key to turn mouse key sequences into strings.
	(Fwhere_is): Check the mouse map too;
	(Fwhere_is_internal): New arg is global map to use.
	All callers changed in keypad.c and doc.c.
	(where_is_string): New fn cvts result of Fwhere_is_internal to string.

Fri Dec  9 23:40:16 1988  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* emacs.c (stack_bottom): New variable, set in main.
	* alloc.c (Fgarbage_collect): Save a copy of the entire stack contents.

Wed Dec  7 17:07:47 1988  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* editfns.c (Funix_umask, Funix_sync): New functions.

	* process.c (Fsignal_process): New function.

Tue Dec  6 21:03:22 1988  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* editfns.c (Fsubst_char_in_region): Fix typo in when to un-modify buf.

Mon Dec  5 14:42:23 1988  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* process.c (create_process): Take the usg's setpgrp and the close-and
	-open of the tty outside the TIOCNOTTY conditional, since TIOCNOTTY
	is always missing outside BSD.  Now the TIOCNOTTY conditional controls
	only the TIOCNOTTY.

Sun Dec  4 11:15:15 1988  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* lread.c (Feval_current_buffer, Feval_region):
	If there is an error, don't restore original point.

	* s-hpux.h (SHORT_CAST_BUG): Define this, for HPUX version 6.2.

	* ymakefile (THIS_IS_YMAKEFILE): Define macro to tell m- files
	to do special things.

	* m/m-ns16000.h: (LOAD_AVE_TYPE, etc.): Don't define them if USG.
	* m/m-ns16000.h [USG]: Define various macros differently.
	(munnari!sibyl.eleceng.ua.oz.au!ian@uunet.uu.net).

	* sysdep.c (reset_sys_modes): Don't output a CR here.
	* term.c (reset_terminal_modes): Do it here, but first
	do a newline if it's a magic cookie terminal.

	* sysdep.c (sys_suspend) [USG]: Use `nice' to set subshell pri. to 0.

	* sysdep.c (TIOCSETN) [USG]: Use TCSETAW, not TCSETA.

	* sysdep.c (setpriority) [USG]: No longer a no-op; use `nice'.

	* keymap.c (Fwhere_is_internal): New 4th arg inhibits looking thru
	indirect definitions--so you can search for one.	

	* alloc.c, fns.c, search.c: Doc fix.

Thu Dec  1 16:46:51 1988  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* process.c (read_process_output): Insert with insert_before_markers.

	* filelock.c (lock_file_1, lock_superlock):
	If USG, use chmod instead of fchmod.

	* environ.c (Fsetenv): Doc fix.

Fri Nov 25 13:41:15 1988  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* eval.c (do_autoload): Verify FUNNAME is a symbol.

Thu Nov 17 23:26:03 1988  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* fileio.c (Fread_file_name): New arg specifies initial minibuf cntnts.
	* callint.c (Fcall_interactively): Calls changed.

Sat Oct  8 03:20:07 1988  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* insdel.c (make_gap): Error if buffer size exceeds range of Lisp int.

Thu Oct  6 05:34:48 1988  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* window.c (Fsplit_window): Prevent error in Fset_window_buffer.

	* sysdep.c (gettimeofday): Store -1 thru tzp so caller knows invalid.

	* xdisp.c (message): Pass 0 as new arg to doprnt.
	* callint.c (Fcall_interactively): Likewise.
	* editfns.c (format1):
	* doprnt.c (doprnt): Allow 0 as FORMAT_END arg meaning null-terminated.

Wed Oct  5 18:43:53 1988  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* keyboard.c: If UNIPLUS, include ioctl.h.

	* sysdep.c (utime): Use new flag IRIS_UTIME, not IRIS.
	* s-iris*.h: Define that flag.

Tue Oct  4 21:04:42 1988  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* term.c (term_init): If have `im' capability, permit ins/del char
	even without `ic'.

Mon Oct  3 00:32:34 1988  Richard Stallman  (rms at corn-chex.ai.mit.edu)

	* m/m-hp9000s300.h: Conditionals for BSD vs HPUX.

	* ymakefile: Look for C_SWITCH_SITE, LD_SWITCH_SITE.

Fri Sep 30 15:48:51 1988  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* editfns.c (Fformat): Allow nulls in the format.
	* doprnt.c (doprnt): likewise.  End of format string is new arg.

Wed Sep 28 15:25:37 1988  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* m/m-7300.h: Undefine SHORTNAMES.  Supposedly newer Unix now.

	* print.c (print): Support new var print_length.
	(syms_of_print): Define Lisp var print-length.
	* eval.c (Fbacktrace): Print unevalled form with print_length = 3.

	* Makefile (tags): Add TAGS as alternate target.
	Process the files in ../lisp/term.

Tue Sep 27 00:55:47 1988  Richard Stallman  (rms at corn-chex.ai.mit.edu)

	* doprnt.c (doprnt): Handle %-20s.
	* editfns.c (Fformat): Likewise (make enough space for it).

	* minibuf.c (do_completion): If get "Complete but not unique" twice
	in a row, display all completions.  New var last_exact_completion.

Mon Sep 26 19:19:23 1988  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

*	* dispnew.c (baud_rate): Now a Lisp variable, not a function.
	* termcap.c (tputs) [emacs]: Use baud_rate as the speed.

Mon Sep 19 00:06:16 1988  Richard Stallman  (rms at gluteus.ai.mit.edu)

	* window.c (Fset_window_configuration): Set deleted windows' buffer
	to nil, via new function delete_all_subwindows.
	* window.c (Fset_window_buffer): Reject deleted windows.
	* window.c (init_window_once): Init the ->buffer fields
	to satisfy error check in Fset_window_buffer.

*	* xmenu.c (Fx_popup_menu): 1st arg is now ((X Y) WINDOW).

	* process.c (child_sig): If synch process terminates, clear
	synch_process_pid and record synch_process_death.
*	* callproc.c (Fcall_process): return synch_process_death.
	Always set synch_process_pid and do it with SIGCHLD masked off.
	* sysdep.c (wait_for_termination) [subprocesses and not VMS]:
	Use alarms to check every second whether synch_process_pid is 0.

Sat Sep 17 17:14:32 1988  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* xdisp.c (redisplay_window): If window-point is outside restriction
	then correct it in the window.
	* window.c (Fdelete_buffer): Don't change buffer's point to a value
	outside its restriction.

	* sysdep.c (init_sys_modes) [MULTI_SCREEN]: Set Vterminal_screen's
	garbaged bit.

Fri Sep 16 01:13:09 1988  Richard Stallman  (rms at corn-chex.ai.mit.edu)

	* keyboard.c (kbd_buffer_get_char): VMS now uses same code as Unix.

	* vmsproc.c: New file for VMS only.
	* callproc.c [VMS]: Omit Fcall_process and child_setup_tty.
	* emacs.c (main) [VMS]: Call init_vmsproc and syms_of_vmsproc.

	* lread.c (OBARRAY_SIZE): Change slightly to 509 (prime).

*	* keyboard.c, dispnew.c, term.c, xterm.c (meta_flag): MetaFlag renamed.
	* keyboard.c (Fset_input_mode): 3rd arg sets meta_flag.
	(syms_of_keyboard): Variable meta-flag deleted.
	* sysdep.c (init_sys_modes): Don't override parity settings
	if meta_flag is 0.

Thu Sep 15 23:29:12 1988  Richard Stallman  (rms at corn-chex.ai.mit.edu)

*	* search.c (Fsearch_forward, etc.): All buffer-search functions
	return new the value of point if they succeed.

Tue Sep 13 12:00:22 1988  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* cmds.c (Fnewline): Correct test of ARG1 to inhibit auto-fill.

Mon Sep 12 16:39:32 1988  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* window.c (Fdelete_window): Put nil as buffer of the deleted window.
	This makes select-window get an error earlier.

Tue Sep  6 20:43:10 1988  Richard Stallman  (rms at sugar-bombs.ai.mit.edu)

	* search.c (search_buffer, string_match, looking_at):	
	Report matcher stack overflow as error, not just failure to match.

	* data.c (Fmake_local_variable): Add local variable to simplify
	too-complex expression.

	* fileio.c (Fdo_auto_save): No "file has shrunk" msg if < 5000 chars.

Local Variables:
mode: indented-text
left-margin: 8
fill-column: 74
version-control: never
End:
