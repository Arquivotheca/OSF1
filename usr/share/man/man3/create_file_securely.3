.\" This manpage source uses rsml coding. 
.so /usr/share/lib/tmac/sml
.so /usr/share/lib/tmac/rsml
.\"
.\"
.\" *********************************************************************
.\" *                                                                   *
.\" *      Copyright (c) Digital Equipment Corporation, 1991, 1994      *
.\" *                                                                   *
.\" *                       All Rights Reserved.                        *
.\" *                                                                   *
.\" *********************************************************************
.\"
.\" HISTORY
.\"
.\" @(#)$RCSfile: create_file_securely.3,v $ $Revision: 1.1.2.5 $ (DEC) $Date: 1994/01/19 22:20:49 $
.\"
.\" From spider@web.zk3.dec.com Fri Jan 14 07:26:20 1994
.TH create_file_securely 3
.SH NAME
.PP
\*Lcreate_file_securely\*O \- Create a file in the authentication database  (Enhanced Security)
.SH LIBRARY
.PP
Security library (\*Llibsecurity.a\*O)
.SH SYNOPSIS
.PP
\*L#include <security.h>\*O
.br
\*L#include <prot.h>\*O
.PP
\*Lint create_files_securely(
.br
	char *file,
.br
        int decibels,
.br
        char *purpose);
.SH PARAMETERS
.PP
.IP "*\*Vfile\*O"
The \*Vfile\*O parameter is the pathname to create.
.IP "\*Vdecibels\*O"
The \*Vdecibels\*O parameter is AUTH_SILENT, AUTH_LIMITED, or AUTH_VERBOSE.
Using AUTH_SILENT blocks signals.
The AUTH_LIMITED constant allows a limited amount of dialog.
Using AUTH_VERBOSE specifies that
the routine should try to wait until the file can be created (up to
100 tries, 1 second apart).
The values for \*Vdecibels\*O are as follows:
.PP
0	AUTH_SILENT
.br
1	AUTH_LIMITED
.br
2	AUTH_VERBOSE
.IP "\*Vpurpose\*O"
The \*Vpurpose\*O parameter is passed to \*Lauditd\*O
when a file can't be created.
It is a tag for the audit log.
.SH DESCRIPTION
.PP
.iX "create_files_securely()"
The \*Lcreate_files_securely\*O routine creates a file as specified in
the authentication database.
It is more flexible than coding the discretionary
attributes of the file, and a further assurance that the file being
created is in accordance with security concerns.
.SH RETURN VALUES
.PP
The \*Lcreate_files_securely\*O routine returns the following values:
0	CFS_GOOD_RETURN
.br
1	CFS_CAN_NOT_OPEN_FILE
.br
2	CFS_NO_FILE_CONTROL_ENTRY
.br
3	CFS_CAN_NOT_CHG_MODE
.br
4	CFS_CAN_NOT_CHG_OWNER_GROUP
.SH FILES
.PP
.VL
.LI "\*L/etc/auth/system/files"
The file control database.
.LE
.SH RELATED INFORMATION
.PP
Files: \*Lfiles(4)\*O
.EQ
delim off
.EN
