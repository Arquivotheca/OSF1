.\" This manpage source uses rsml coding. 
.so /usr/share/lib/tmac/sml
.so /usr/share/lib/tmac/rsml
.\"
.\"
.\" *********************************************************************
.\" *                                                                   *
.\" *      Copyright (c) Digital Equipment Corporation, 1991, 1994      *
.\" *                                                                   *
.\" *                       All Rights Reserved.                        *
.\" *                                                                   *
.\" *********************************************************************
.\"
.\" HISTORY
.\"
.\" @(#)$RCSfile: getpwent.3,v $ $Revision: 3.5.7.10 $ (DEC) $Date: 1994/01/15 02:16:32 $
.\"
.\" (c) Copyright 1991, OPEN SOFTWARE FOUNDATION, INC.
.\" ALL RIGHTS RESERVED
.\" 
.\" Begin Digital-specific information
.\" Added getpwnam_r to the NAME line per QAR 7913.
.\" Also made a few coding changes to pass tman.
.\" End Digital-specific information
.\"
.\" (c) Copyright 1990, 1991, 1992, 1993 OPEN SOFTWARE FOUNDATION, INC. 
.\" ALL RIGHTS RESERVED 
.\" OSF/1 1.2
.\"
.TH getpwent 3
.SH NAME
.PP
\*Lgetpwent\*O, \*Lgetpwent_r\*O, \*Lgetpwuid\*O, \*Lgetpwuid_r\*O, \*Lgetpwnam\*O, \*Lgetpwnam_r\*O, \*Lputpwent\*O, \*Lsetpwent\*O, \*Lsetpwent_r\*O, \*Lendpwent\*O, \*Lendpwent_r\*O, \*Lfgetpwent\*O, \*Lfgetpwent_r\*O \- Access user attribute information in the user database
.SH LIBRARY
.PP
\*OStandard C Library \*L(libc.a)
.SH SYNOPSIS
.PP
.sS
\*L#include <stdio.h>
.sp 0.4v
\*L#include <pwd.h>
.sp 0.4v
\*Lstruct passwd *getpwent(void);
.sp 0.4v
\*Lint getpwent_r(
.nL
	\*Lstruct passwd *\*Vresult\*L,\*L
.nL
	\*Lchar *\*Vbuffer\*L,
.nL
	\*Lint \*Vlen\*L,
.nL
	\*LFILE **\*Vpw_fp\*L);
.sp 0.4v
\*Lstruct passwd \(**getpwuid(
.nL
	\*Luid_t \*Vuid\*L);
.PP
\*Lint getpwuid_r(
.nL
	\*Luid_t \*Vuid\*L,
.nL
	\*Lstruct passwd *\*Vresult\*L,\*L
.nL
	\*Lchar *\*Vbuffer\*L,
.nL
	\*Lint \*Vlen\*L);
.PP
\*Lstruct passwd \(**getpwnam(
.nL
	\*Lconst char \(**\*Vname\*L);
.PP
\*Lint getpwnam_r(
.nL
	\*Lconst char *\*Vname\*L,
.nL
	\*Lstruct passwd *\*Vresult\*L,\*L
.nL
	\*Lchar *\*Vbuffer\*L,
.nL
	\*Lint \*Vlen\*L);
.PP
\*Lint putpwent(
.nL
	struct passwd *\*Vpasswd\*L,
.nL
	FILE *\*Vfile\*L);
.PP
\*Lint setpwent(void);\*O
.PP
\*Lint setpwent_r(FILE **\*Vpw_fp\*L);\*O
\*O\c
.PP
\*Lvoid endpwent(void);
.PP
\*Lvoid endpwent_r(FILE **\*Vpw_fp\*L);\*O
.PP
\*Lstruct passwd *fgetpwent (FILE *\*Vf\*L);\*O
.sp 0.4v
\*Lint fgetpwent_r(
.nL
	\*LFILE *\*Vf\*L,
.nL
	\*Lstruct passwd *\*Vresult\*L,\*L
.nL
	\*Lchar *\*Vbuffer\*L,
.nL
	\*Lint \*Vlen\*L);
.PP
\*Lvoid setpwfile(
.nL
	\*Lconst char *\*Vfilename\*L);
.sE
.SH PARAMETERS
.PP
.VL
.LI "\*Vuid"
\*OSpecifies the ID of the user for which the
attributes are to be read.
.\"from TP "  
.LI "\*Vname"
\*OSpecifies the name of the user for which the
attributes are to be read.
.\"from TP "  
.LI "\*Vpasswd"
\*OSpecifies the password structure that contains the
user attributes that are to be written.
.\"from TP "  
.LI "\*Vfile"
\*OSpecifies a stream open for writing to a file.
.\"from TP "  
.LI "\*Vresult"
\*OPoints to
the \*Lpasswd\*O
structure that will contain the entry returned by the
\*Lgetpwnam_r(\|)\*O,
\*Lgetpwuid_r(\|)\*O,
\*Lgetpwent_r(\|)\*O,
or
\*Lfgetpwent_r(\|)\*O
functions.
.\"from TP "  
.LI "\*Vbuffer"
\*OA working buffer for the \*Vresult\*O parameter that is able to
hold the largest
password entry in \*L/etc/passwd\*O.
[Digital only] The minimum buffer size is 1024 bytes as defined for SIABUFSIZ
in \*L/usr/include/sia.h\*O.
.\" End Digital-specific information
.\"from TP "  
.LI "\*Vlen"
\*OSpecifies the length of the character array
that
\*Vbuffer\*O
points to.
[Digital only] The minimum buffer size is 1024 bytes as defined for SIABUFSIZ
in \*L/usr/include/sia.h\*O.
.\" End Digital-specific information
.LI "\*Vf\*O"
Specifies a file that contains the next passwd structure.  (This is
for the \*Lfgetpwent(\|)\*O and \*Lfgetpwent_r(\|)\*O functions.)
.LI "\*Vpw_fp\*O"
Points to a file stream open for reading password entries.
.LI "\*Vfilename\*O"
Specifies a new default password file rather than using the default
\*L/etc/passwd\*O file.
.LE
.SH DESCRIPTION
.PP
.iX "getpwent function"
.iX "getpwent_r function"
.iX "getpwuid function"
.iX "getpwuid_r function"
.iX "getpwnam function"
.iX "getpwnam_r function"
.iX "putpwent function"
.iX "setpwent function"
.iX "setpwent_r function"
.iX "endpwent function"
.iX "endpwent_r function"
.iX "fgetpwent function"
.iX "fgetpwent_r function"
.iX "database" "manipulating entry in user"
.iX "user database" "defined"
.iX "user database" "manipulating entry in"
.iX "user password"
The
\*Lgetpwent(\|)\*O,
\*Lgetpwuid(\|)\*O,
\*Lgetpwnam(\|)\*O,
\*Lputpwent(\|)\*O,
\*Lsetpwent(\|)\*O,
\*Lendpwent(\|)\*O,
and \*Lfgetpwent(\|)\*O
functions may be used to access the basic user attributes.
.PP
The \*Lgetpwent(\|)\*O, \*Lgetpwnam(\|)\*O, and \*Lgetpwuid(\|)\*O
functions return information about the specified user.  The \*Lgetpwent(\|)\*O
function returns the next user entry in a sequential search.
The \*Lgetpwnam(\|)\*O function
returns the first user entry in the database with a
\*Lpw_name\*O
field that matches the \*Vname\*O parameter.
The \*Lgetpwuid(\|)\*O function returns
the first user entry in the database with a
\*Lpw_uid\*O
field that matches the \*Vuid\*O
parameter.
.PP
The \*Lputpwent(\|)\*O function writes a password entry into
a file in the colon-separated format of the \*L/etc/passwd\*O file.
.PP
The
\*Lsetpwent(\|)\*O
function ensures that the next call to
\*Lgetpwent(\|)\*O
returns the first entry.
.PP
\*OThe \*Lendpwent(\|)\*O function closes the user database.
.PP
The user structure, which is returned by the \*Lgetpwent(\|)\*O,
\*Lgetpwnam(\|)\*O,
and \*Lgetpwuid(\|)\*O functions and which is written by the \*Lputpwent(\|)\*O
function, is defined in the \*Lpwd.h\*O file and has
the following members:
.\"from TP "  
.VL
.LI "\*Lpw_name"
\*OThe name of the user.
.\"from TP "  
.LI "\*Lpw_passwd"
\*OThe encrypted password of the user.
If the password is not stored in the
\*L/etc/passwd\*O
file and the invoker
does not have access to the shadow file that contains them, this
field will contain an unencryptable string, usually an \*L!\*O (exclamation
point).
.\"from TP "  
.LI "\*Lpw_uid"
\*OThe ID of the user.
.\"from TP "  
.LI "\*Lpw_gid"
\*OThe group ID of the principle group of the user.
.\"from TP "  
.LI "\*Lpw_gecos"
\*OThe personal information about the user.
.\"from TP "  
.LI "\*Lpw_dir"
\*OThe home directory of the user.
.\"from TP "  
.LI "\*Lpw_shell"
\*OThe initial program for the user.
.LE
.PP
The
\*Lgetpwuid_r(\|)\*O,
\*Lgetpwnam_r(\|)\*O,
\*Lsetpwent_r(\|)\*O,
\*Lgetpwent_r(\|)\*O,
\*Lendpwent_r(\|)\*O, and
\*Lfgetpwent_r(\|)\*O
functions are the reentrant versions of the
\*Lgetpwuid(\|)\*O,
\*Lgetpwnam(\|)\*O,
\*Lsetpwent(\|)\*O,
\*Lgetpwent(\|)\*O,
\*Lendpwent(\|)\*O, and
\*Lfgetpwent(\|)\*O
functions,
respectively. The \*Lgetpwent_r(\|)\*O, \*Lsetpwent_r(\|)\*O, and
\*Lendpwent_r(\|)\*O functions use the \*Vpw_fp\*O parameter to keep track
of the calls to the \*Lgetpwent_r(\|)\*O function, so that subsequent calls
will return subsequent password entries from the \*L/etc/passwd\*O
file.  The \*Lsetpwent_r(\|)\*O function must be called with the
address of a valid file pointer (which may be NULL).
Upon successful completion, the result is stored in
\*Vresult\*O.
.PP
The \*Lfgetpwent(\|)\*O and \*Lfgetpwent_r(\|)\*O functions get a
password file entry from the
file specified by the \*Vf\*O parameter, rather than
from the \*L/etc/passwd\*O file.
This file must have the format of the \*L/etc/passwd\*O file.
.PP
The \*Lsetpwfile(\|)\*O function sets the new default password file to
be \*Vfilename\*O instead of \*L/etc/passwd\*O.
.PP
The system searches using NIS if NIS is available and your
\*L/etc/passwd\*O file has NIS type entries (that is, +:, +\*Vname\*O,
+@\*Vnetgroup\*O, and -@\*Vnetgroup\*O).
The \*Lfgetpw*\*O routines do not use NIS.
The operating system provides the
\*Lgetpwent_local\*O,
\*Lgetpwuid_local\*O, and
\*Lgetpwnam_local\*O
routines to avoid NIS. The \*Lgetpw*_local\*O routines are provided only
on Digital systems and are not in the \*Lpwd.h\*O header file.
.\" NIS distributed \*Lpasswd\*O file for the requested information.
.\" To determine which file or files to search, and
.\" in which order, the system uses the switches in the \*L/etc/svc.conf\*O file.
.\" End Digital-specific information
.SH NOTES
.PP
\*OAll information generated by the \*Lgetpwent(\|)\*O, \*Lfgetpwent(\|)\*O,
\*Lgetpwnam(\|)\*O, and \*Lgetpwuid(\|)\*O functions is stored in
a static area and will be overwritten on subsequent calls to these
routines.
.PP
Password file entries which are too long are ignored.
.PP
Note that the \*Lpw_fp\*O parameter must be initialized by the user to
NULL before the \*Lsetpwent_r(\|)\*O function is called for the first time.
.PP
.PP
If the system is configured to access the basic user attributes
database through NIS, the \*Lgetpwent_r(\|)\*O  function may not
produce correct results if called from multiple threads.
.VL 1.5i
.LI "\*LAES Support Level:\*O"
Full use (\*Lgetpwnam(\|)\*O, \*Lgetpwuid(\|)\*O).
.LE
.SH RETURN VALUES
.PP
Upon successful completion,
the \*Lgetpwent(\|)\*O, \*Lgetpwnam(\|)\*O, \*Lgetpwuid(\|)\*O, and
\*Lfgetpwent(\|)\*O
functions return a pointer to a valid password structure.
Otherwise, NULL is returned.
.PP
Upon successful completion, the \*Lgetpwent_r(\|)\*O,
\*Lgetpwnam_r(\|)\*O,
\*Lgetpwuid_r(\|)\*O, and
\*Lfgetpwent_r(\|)\*O,
functions return a value of 0 (zero).  Otherwise, a value of -1 is returned,
and
\*Lerrno\*O
is set to indicate the error.
.SH ERRORS
.PP
If any of the following conditions occurs, the \*Lgetpwent_r(\|)\*O,
\*Lfgetpwent_r(\|)\*O,
\*Lgetpwnam_r(\|)\*O
and
\*Lgetpwuid_r(\|)\*O
functions set \*Lerrno\*O to the corresponding value:
.\"from TP 1i"  
.VL 1i
.LI "[EINVAL]"
Either the
\*Vresult\*O
or
\*Vbuffer\*O
parameter is invalid, or \*Vlen\*O is too small.
.\"from TP 1i"  
.LE
.PP
In addition, if any of the following conditions occurs, the
\*Lgetpwnam_r(\|)\*O, \*Lgetpwuid_r(\|)\*O, and
\*Lgetpwent_r(\|)\*O functions
set \*Lerrno\*O to the corresponding value:
.VL
.LI "[ESRCH]"
The entry could not be found.
.LE
.SH RELATED INFORMATION
.PP
Functions:
\*Lgetgrent\*O(3).
.iX "getpwent function"
.iX "getpwent_r function"
.iX "getpwuid function"
.iX "getpwuid_r function"
.iX "getpwnam function"
.iX "getpwnam_r function"
.iX "putpwent function"
.iX "setpwent function"
.iX "endpwent function"
.iX "setpwent_r function"
.iX "endpwent_r function"
.EQ
delim off
.EN
